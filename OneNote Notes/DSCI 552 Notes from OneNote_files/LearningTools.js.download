function getLanguageParameter(n){for(var t,f=window.location.search.substr(1),r=f.split("&"),u="",i=0;i<r.length;i++)if(t=r[i].split("=",2),t.length==2&&t[0]=="ui"){u=""+n+"="+t[1];break}return u}function getEdgeMajorVersion(){var t=navigator.userAgent,n=t.match(/Edge\/([0-9]+)/i);return n&&n.length>=2?parseInt(n[1]):-1}function getQueryParameter(n){var u,r,t,i;if(window.location.search&&window.location.search.length>1)for(u=window.location.search.substring(1),r=u.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),decodeURIComponent(i[0])==n)return i.length>1?decodeURIComponent(i[1]):"";return null}function now(){return(new Date).getTime()}function generateGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n==="x"?t:t&3|8;return i.toString(16)})}function createSimpleHtml(n,t,i){i===void 0&&(i=null);var r=document.createElement(n);return r.innerText=t||"",i&&r.setAttribute("lang",i),r.outerHTML}function loadTableAsync(n,t,i,r){var o,u,f,s,e,h;for(i===void 0&&(i=0),r===void 0&&(r=0),o=t.rows.items,u=[],f=i;f<o.length;f++)for(s=o[f].cells.items,e=r;e<s.length;e++)h=s[e],Array.prototype.push.apply(u,loadParagraphs(h));return u.length>0?n.sync().then(function(){return processLoadedObjectsRecursivelyAsync(n,u)}):OfficeExtension.Promise.resolve(!0)}function processLoadedObjectsRecursivelyAsync(n,t,i){var r,u,f,e;for(i===void 0&&(i=0),r=i;r<t.length;r++){u=t[r];switch(u.type){case"table":return f=u.object,loadTableAsync(n,f).then(function(){return processLoadedObjectsRecursivelyAsync(n,t,r+1)});case"text":return e=u.object,loadParagraphsRecursivelyAsync(n,e).then(function(){return processLoadedObjectsRecursivelyAsync(n,t,r+1)})}}return OfficeExtension.Promise.resolve(!0)}function loadParagraphs(n){for(var t,u,f,e,o,s=n.paragraphs.items,i=[],r=0;r<s.length;r++){t=s[r];switch(t.type){case"Table":u=t.table;u.load("rows/cells/paragraphs");i.push({type:"table",object:u});break;case"Image":f=t.image;f.load("ocrData,description");i.push({type:"image",object:f});break;case"RichText":e=t;e.load("richText/text,richText/style,paragraphs");i.push({type:"text",object:e});break;case"Ink":o=t;o.load("inkWords");i.push({type:"ink",object:o})}}return i}function loadParagraphsRecursivelyAsync(n,t){var i=loadParagraphs(t);return i.length>0?n.sync().then(function(){return processLoadedObjectsRecursivelyAsync(n,i)}):OfficeExtension.Promise.resolve(!0)}function shouldUseImageDescription(n){return n!=null&&n.length>0&&n.indexOf("Office Lens")==-1&&n.indexOf("cid:")!=0&&n.indexOf("Machine Generated")==-1}function getImageDescriptionOrOcrData(n){var t=getHtmlFromImageOcrData(n);return t?t:shouldUseImageDescription(n.description)?{html:{value:createSimpleHtml("p",n.description)}}:null}function getHtmlFromImageOcrData(n){var t=n.ocrData,i;return t&&t.ocrText?(i=createSimpleHtml("p",t.ocrText,t.ocrLanguageId),SendHtmlChunks&&(i=i.replace(/<br\s*\/?>/ig," ")),{html:{value:i}}):null}function getInkWordsAsHtml(n){for(var t,r=[],i=0;i<n.length;i++)t=n[i],!t.isNull&&t.wordAlternates.length>0&&r.push(createSimpleHtml("span",t.wordAlternates[0],t.languageId));return"<p>"+r.join(" ")+"<\/p>"}function getInkAnalysisText(n){for(var e,t,o,i,r,h,f=[],s=n.paragraphs.items,u=0;u<s.length;u++)for(e=s[u].lines.items,t=0;t<e.length;t++)for(o=e[t].words.items,i=0;i<o.length;i++)r=o[i],!r.isNull&&r.wordAlternates.length>0&&(h=(t>0||t==0&&u>0)&&i==0?"\n":"",f.push(h+createSimpleHtml("span",r.wordAlternates[0],r.languageId)));return f.length>0?{html:{value:"<p>"+f.join(" ")+"<\/p>"}}:null}function loadTextsRecursively(n,t){for(var i,a,o,r,s,u,v,h,f,c,y,p,l=n.paragraphs.items,e=0;e<l.length;e++){i=l[e];switch(i.type){case"Table":for(a=i.table,o=a.rows.items,r=0;r<o.length;r++)for(s=o[r].cells.items,u=0;u<s.length;u++)v=s[u],loadTextsRecursively(v,t);break;case"Image":h=getImageDescriptionOrOcrData(i.image);h&&t.push(h);break;case"RichText":f=i;c=null;try{c=f.richText.style}catch(w){}t.push({html:f.richText.getHtml(),paragraphInfo:i.getParagraphInfo(),style:c});loadTextsRecursively(f,t);break;case"Ink":y=i.inkWords.items;p=getInkWordsAsHtml(y);t.push({html:{value:p}})}}}function getPageDataFromHtml(n,t){var r={title:n,appId:getAppId(),chunks:[]},i=0,o=navigator.language||"IVL",u,s,f,e;try{for(u=0;u<t.length;u++){if(s=t[u].html.value,f=$(s),f.attr("lang")){o=f.attr("lang");break}if(e=f.find("[lang]:first"),e.length>0&&e.attr("lang")){o=e.attr("lang");break}}}catch(h){Logging.ULS.sendTraceTag(21869575,2003,Diag.ULSTraceLevel.warning,"Error parsing full HTML for default language extraction.  Exception: "+JSON.stringify(h))}return t.forEach(function(n){var h=n.html.value,e=$(h),u=null,t="",y=e.attr("lang")||o,c=e.text(),l=!1,s;u==null&&(u=y);var f="[if mathML]",a="![endif]",v="application/mathml+xml";(c.length>0||h.indexOf(f)!=-1)&&(s=e.contents(),s.length>0?s.each(function(){var o=$(this),h=o.attr("lang")||u,c=null,n=o.text(),e,y,s;(o.length==1&&o[0].nodeType==Node.COMMENT_NODE&&(e=o[0].textContent,e&&e.indexOf(f)!=-1&&e.indexOf(a)!=-1&&(n=e.substring(e.indexOf(f)+f.length,e.indexOf(a)),n.indexOf("&#62;")==0&&(n=$("<textarea/>").html(n).text()),n[0]===">"&&n[n.length-1]==="<"&&(n=n.substr(1,n.length-2)),c=v)),n.length!=0)&&(y=h&&u!=h,s=c==v,y||s?((t.length>0||s&&i>0)&&(r.chunks.push({lang:u,content:Array(i).join("\n")+t}),i=1),t=n):t+=n,y&&(u=h),s&&(r.chunks.push({lang:u,mimeType:c,content:t}),l=!0,t=""))}):t=c,t.length>0?(r.chunks.push({lang:u,content:Array(i).join("\n")+t}),i=1,t=""):l&&i===0&&(i=1));i++}),r.chunks.length==0&&r.chunks.push({content:""}),r}function getPageDataAsHtml(n,t){var i={title:n,appId:getAppId(),chunks:[]};return i.chunks.push({mimeType:"text/html",content:getPageHtml(t)}),i}function getPageHtml(n){var t=[];return n.forEach(function(n){var i=n.html.value;i=applyParagraphInfo(i,n);t.push(i)}),t.join("")}function applyParagraphInfo(n,t){var h,i,e,o;if(t.paragraphInfo&&t.paragraphInfo.value){var f=t.paragraphInfo.value,s=f,u="",r;if(f.listType&&f.listType!="None")if(f.listType=="Number"){h=f.index;switch(f.numberType){case"LCLetter":r="lowerAlpha";break;case"UCLetter":r="upperAlpha";break;case"LCRoman":r="lowerRoman";break;case"UCRoman":r="upperRoman";break;case"Arabic":default:r="decimal"}u+="li:"+h.toString()+";"}else f.listType=="Bullet"&&(r="disc");if(s.indentationLevel&&s.indentationLevel>0&&(r==null&&(r="none;"),u+="in:"+s.indentationLevel.toString()+";"),r!=null&&(u="lt:"+r+";"+u),t.style){i=null;switch(t.style){case 4:i="h1";break;case 5:i="h2";break;case 6:i="h3";break;case 7:i="h4";break;case 8:i="h5";break;case 9:i="h6";break;case 2:i="title";break;case 10:i="quote";break;case 11:i="cite";break;case 12:i="code"}i!=null&&(u="n:"+i+";"+u)}u.length>0&&(e=document.createElement("div"),e.innerHTML=n,e.children.length==1&&e.children[0].tagName=="P"?o=e.children[0]:(o=document.createElement("p"),o.innerHTML=n),o.setAttribute("st",u),n=o.outerHTML)}return n}function sortContentElementsVisually(n,t){return n.top==t.top?n.left-t.left:n.top-t.top}function loadActivePageContent(){return OneNote.run(function(n){var t=n.application.getActivePageOrNull();return t.load("title,inkanalysisornull/paragraphs/lines,contents/type,contents/top,contents/left"+(isRichApp?",parentSection":"")),n.sync().then(function(){var i,f,r,u;if(t.isNull)throw{name:"RichApi.Error",code:"ItemNotFound",debugInfo:{errorLocation:"Application.getActivePage"}};for(i=[],t.contents.items.sort(sortContentElementsVisually),f=0;f<t.contents.items.length;f++){r=t.contents.items[f];switch(r.type){case"Outline":r.load("outline/paragraphs/type");i.push(r.outline);break;case"Image":r.load("image/ocrData,image/description");i.push(r.image)}}return u=t.inkAnalysisOrNull,u&&!u.isNull&&(u.load("paragraphs/lines/words"),i.push(u)),n.sync().then(function(){for(var u,f=[],r=0;r<i.length;r++)u=i[r],u instanceof OneNote.Outline&&Array.prototype.push.apply(f,loadParagraphs(u));return n.sync().then(function(){return processLoadedObjectsRecursivelyAsync(n,f).then(function(){for(var r,e,o,u=[],f=0;f<i.length;f++)r=i[f],r instanceof OneNote.Outline?loadTextsRecursively(r,u):r instanceof OneNote.Image?(e=getImageDescriptionOrOcrData(r),e&&u.push(e)):r instanceof OneNote.InkAnalysis&&(o=getInkAnalysisText(r),o&&u.push(o));return n.sync().then(function(){var i;return i=SendHtmlChunks?getPageDataAsHtml(t.title,u):getPageDataFromHtml(t.title,u),postPageDataJson(n,i)})})})})})}).catch(function(n){return handleLoadError(n)})}function loadMathPaneContent(){return OneNote.run(function(n){var i=n.application.getActivePage(),t;return i.load("title"+(isRichApp?",parentSection":"")),t=n.application._GetMathPaneContent(),n.sync().then(function(){var i=t.value;return n.sync().then(function(){var t={title:"",appId:getAppId(),chunks:[{lang:navigator.language||"IVL",mimeType:"text/x-mathpane-html",content:i}]};return postPageDataJson(n,t)})})}).catch(function(n){return handleLoadError(n)})}function handleLoadError(n){var t=null;try{n.name==="RichApi.Error"&&(n.code==="ItemNotFound"||n.code==="AccessDenied")&&(n.debugInfo.errorLocation==="Application.getActivePage"||n.debugInfo.errorLocation==="Page.inkAnalysisOrNull")&&(t="NoActivePage")}catch(i){}finally{t===null?Logging.ULS.sendTraceTagEx(20717783,2003,Diag.ULSTraceLevel.error,1,"API error: "+JSON.stringify(n)+", ltSessionId: "+ltSessionId+", sessionId: "+SessionId):Logging.ULS.sendTraceTag(40445057,2003,Diag.ULSTraceLevel.info,"API error: "+JSON.stringify(n)+", customErrorType: "+t+", ltSessionId: "+ltSessionId+", sessionId: "+SessionId)}return n.sessionId=ltSessionId,{messageType:"HostError",messageValue:{customErrorType:t,details:JSON.stringify(n)}}}function postPageDataJson(n,t){var i,r;return UseV2Api&&(i={data:t}),isRichApp?UseV2Api?getContentModelAsync(n,JSON.stringify(i)).then(function(n){return{messageType:"LinguisticModel",messageValue:n}}):getReaderModel11Async(n,JSON.stringify(t)).then(function(n){return{messageType:"ReaderModel",messageValue:n}}):(r=UseV2ApiWac?n.application._SendDataToLearningToolsV2(JSON.stringify(i),ltSessionId):n.application._SendDataToLearningTools(JSON.stringify(t),ltSessionId),n.sync().then(function(){var n=JSON.parse(r.value);return{messageType:UseV2ApiWac?"LinguisticModel":"ReaderModel",messageValue:n}}))}function getOneNoteServiceAuthToken(n){return new OfficeExtension.Promise(function(t,i){var r=null,u=n.application;r=u._GetServiceTokens("OneService");n.sync().then(function(){r!=null&&r.value.length>0?t(r.value[0].headerValue):(Logging.ULS.sendTraceTagEx(22595671,2003,Diag.ULSTraceLevel.error,1,"Unable to locate OneService Auth token, ltSessionId: "+ltSessionId+", sessionId: "+SessionId),i())})})}function getRegionSpecificLearningToolsDomain(){var n=window.location.hostname;return n.toLowerCase().indexOf("dev.onenote-int.com")!=-1?"www.edog.onenote.com":isRichApp&&IsProductionEnvironment&&!IsEdogEnvironment?"learningtools.onenote.com":n}function getAppId(){var n=HostingAppPlatforms.getAppIdFromPlatformName(Office.context.platform);return n||(Logging.ULS.sendTraceTag(25282572,2003,Diag.ULSTraceLevel.warning,"Unknown platform ("+Office.context.platform+") launched the Learning Tools Agave"),n=HostingAppPlatforms.AppPlatforms.Unknown.appId),n}function callLearningToolsServiceAsync(n,t,i){return new OfficeExtension.Promise(function(r,u){getOneNoteServiceAuthToken(n).then(function(n){var f=getRegionSpecificLearningToolsDomain(),e="https://"+f+"/learningtoolsapi/"+i;$.ajax({type:"POST",url:e,data:t,beforeSend:function(t){t.setRequestHeader("Content-type","application/json");t.setRequestHeader("MS-Int-AppId",getAppId());t.setRequestHeader("Authorization",n);t.setRequestHeader("X-OAuthBypass","118C7158-C918-4FF8-82AD-5BA564F19A5B")}}).done(function(n){r(n)}).fail(function(n,t,i){Logging.ULS.sendTraceTagEx(22356544,2003,Diag.ULSTraceLevel.error,1,"API error: "+JSON.stringify(i)+", ltSessionId: "+ltSessionId+", sessionId: "+SessionId+", Response HTTP code: "+n.status);u("GetReaderModel API error: "+JSON.stringify(i)+", Response HTTP code: "+n.status)})}).catch(function(n){Logging.ULS.sendTraceTagEx(22595672,2003,Diag.ULSTraceLevel.error,1,"API error: "+JSON.stringify(n)+", ltSessionId: "+ltSessionId+", sessionId: "+SessionId);u("GetReaderModel API error: "+JSON.stringify(n))})})}function getContentModelAsync(n,t){return callLearningToolsServiceAsync(n,t,"v2.0/GetContentModelForReader")}function getReaderModel11Async(n,t){return callLearningToolsServiceAsync(n,t,"v1.1/reader-oauth")}function okToLaunch(){return agaveRunning?!1:(agaveRunning=!0,!0)}function launchImmersiveReaderDialog(n){try{if(okToLaunch()){ltSessionId=generateGuid();launchTime=now();var t="https://"+location.hostname+"/officeaddins/learningtools/ImmersiveReader?"+getLanguageParameter("ui")+"&sessionId="+ltSessionId+"&appId="+getAppId()+"&logMode="+Logging.logMode+"&fullScreen";Office.context.ui.displayDialogAsync(t,{width:100,height:100,displayInIframe:!0,hideTitle:!0},function(n){if(n.value&&(dialogHandler=n.value,dialogHandler&&(dialogHandler.addEventHandler(Microsoft.Office.WebExtension.EventType.DialogMessageReceived,dialogMessageHandler),dialogHandler.addEventHandler(Microsoft.Office.WebExtension.EventType.DialogEventReceived,dialogEventHandler)),isRichApp)){var t=new OneNote.RequestContext;t.application._EnterFullScreen();t.sync();Logging.ULS.oneNoteLoggingContext=t}});Logging.ULS.sendTraceTag(20717784,2003,Diag.ULSTraceLevel.info,"Immersive reader dialog launched")}}finally{n&&n.completed()}}function launchImmersiveMathReaderDialog(n){wasLaunchedFromMathPane=!0;Logging.ULS.sendTraceTag(39679192,2003,Diag.ULSTraceLevel.info,"Launched from the OneNote Math Pane");launchImmersiveReaderDialog(n)}function dialogMessageHandler(n){var t=JSON.parse(n.message),i,r;switch(t.Type){case 0:getCurrentPageData(function(n){Logging.ULS.sendTraceTag(20717785,2003,Diag.ULSTraceLevel.info,"Sending page data to dialog");n.launchToPostMessageSentDurationInMs=now()-launchTime;dialogHandler.sendMessage(JSON.stringify(n))});break;case 1:isRichApp&&(i=new OneNote.RequestContext,i.application._ExitFullScreen(),i.sync());dialogHandler.close();agaveRunning=!1;break;case 2:t.Content&&(r=JSON.parse(t.Content),Logging.ULS.sendTraceInfo(r))}}function dialogEventHandler(n){n.error===12006&&(agaveRunning=!1)}function getCurrentPageData(n){wasLaunchedFromMathPane?(wasLaunchedFromMathPane=!1,loadMathPaneContent().then(function(t){n(t)})):loadActivePageContent().then(function(t){n(t)})}var Logging,HostingAppPlatforms,ErrorReporting,BrowserUlsUploadPath,Diag;(function(n){var i,t;(function(n){(function(n){n[n.DialogReady=0]="DialogReady";n[n.CloseDialog=1]="CloseDialog";n[n.LogTrace=2]="LogTrace"})(n.MessageType||(n.MessageType={}));var i=n.MessageType,t=function(){function n(){}return n}();n.Message=t})(i=n.Messages||(n.Messages={}));n.logMode=0;t=function(){function t(){}return t.sendTraceTag=function(i,r,u,f){n.logMode===1&&Diag.ULS.sendTraceTag(i,r,u,f);t.sendTraceTagToHostApp(i,r,u,f)},t.sendTraceTagEx=function(i,r,u,f,e){n.logMode===1&&Diag.ULS.sendTraceTag(i,r,u,e);t.sendTraceTagToHostAppEx(i,r,u,f,e)},t.sendTraceTagToHostApp=function(n,i,r,u){var s,h;if(t.routeHostLogTrace)t.routeHostLogTrace(n,i,r,u);else if(t.oneNoteLoggingContext){var c=t.convertTagIdToTagCode(n),f="Trace",e="DefaultFlag",l=t.getEventPrefix(i),o="Trace",a="."+c;r==Diag.ULSTraceLevel.error&&(f="Exception",e="CriticalFlag",o="Exception");s={tag:"Output",value:u,isNonPII:!0};h=[s];t.oneNoteLoggingContext.application._ClientLog(f,l+o+a,e,h);t.oneNoteLoggingContext.sync()}},t.sendTraceTagToHostAppEx=function(n,i,r,u,f){var a,e;if(t.routeHostLogTrace)t.routeHostLogTrace(n,i,r,f);else if(t.oneNoteLoggingContext){var o=t.convertTagIdToTagCode(n),s="Trace",h="DefaultFlag",v=t.getEventPrefix(i),c="Trace",l="."+o;r==Diag.ULSTraceLevel.error&&(s="Exception",h="CriticalFlag",c="Exception",l="",f=o+": "+f);a={tag:"Output",value:f,isNonPII:!0};e=[a];u!=0&&e.push({tag:"DiagnosticLevel",value:u.toString(),isNonPII:!0});t.oneNoteLoggingContext.application._ClientLog(s,v+c+l,h,e);t.oneNoteLoggingContext.sync()}},t.getEventPrefix=function(n){var t="Education.";switch(n){case 2002:t+="ClassNotebook.";break;case 2003:t+="LearningTools.ImmersiveReader."}return t},t.sendTraceInfo=function(n){t.sendTraceTagToHostApp(n.tagId,n.categoryId,n.level,n.output)},t.sendTraceMessageToParentApp=function(n,t,i,r){var u={tagId:n,categoryId:t,level:i,output:r},f={Type:2,Content:JSON.stringify(u)};Office.context.ui.messageParent(JSON.stringify(f))},t.convertTagIdToTagCode=function(n){var o="abcdefghijklmnopqrstuvwxyz0123456789",r="",s=Math.floor(n),u,t,h,f,i,e;if(s<=65535)return s.toString();for(u=5,t=6,n>>24>=36&&(u=4,t=8),h=(1<<t)-1,f=0;f<u;f++){if(i=n&h,e=String.fromCharCode(i),t==6){if(i<0||i>=o.length)return r;e=o.charAt(i)}r=e+r;n>>=t}return r},t}();n.ULS=t})(Logging||(Logging={}));HostingAppPlatforms=function(){function n(){}return n.findPlatformApp=function(t){var r=n.AppPlatforms,u,i;for(u in r)if(i=r[u],t(i))return i;return null},n.getPlatformAppByPlatformName=function(t){return n.findPlatformApp(function(n){return n.platform===t})},n.isRichPlatform=function(t){var i=n.getPlatformAppByPlatformName(t);return!!i&&i.isRichApp},n.isRichApplication=function(t){return!!n.findPlatformApp(function(n){return n.appId===t&&n.isRichApp})},n.getAppIdFromPlatformName=function(t){var i=n.getPlatformAppByPlatformName(t);if(i)return i.appId},n.AppPlatforms={OneNoteWAC:{platform:"OfficeOnline",appId:"OneNote WAC",isRichApp:!1},OneNoteUWP:{platform:"Universal",appId:"OneNote UWP",isRichApp:!0},OneNoteIOS:{platform:"iOS",appId:"OneNote iOS",isRichApp:!0},OneNoteMac:{platform:"Mac",appId:"OneNote Mac",isRichApp:!0},Unknown:{platform:"Unknown",appId:"Unknown Agave Host",isRichApp:!1}},n}(),function(n){function t(n,t,i,r,u){return"JavaScript Error:\nMessage: "+(n||"")+"\nStack: "+(u||"")+"\nFile name: "+(t||"")+"\nLine number: "+(i||"")+"\nColumn number: "+(r||"")}function i(t,i,r,u,f){var e=n.GetErrorString(t,i,r,u,f);Logging.ULS.sendTraceTagEx(25206881,2003,Diag.ULSTraceLevel.error,1,e)}n.GetErrorString=t;n.ReportError=i}(ErrorReporting||(ErrorReporting={}));window.onerror=function(n,t,i,r,u){try{var f="";u instanceof Error&&(f=u.stack);ErrorReporting.ReportError(n,t,i,r,f)}catch(e){}};BrowserUlsUploadPath="/officeaddins/RemoteUls.ashx",function(n){(function(n){n[n.TempCategory=2e3]="TempCategory";n[n.OneNoteAgaves_TempCategory=2e3]="OneNoteAgaves_TempCategory";n[n.Meetings=2001]="Meetings";n[n.OneNoteAgaves_Meetings=2001]="OneNoteAgaves_Meetings";n[n.ClassNotebook=2002]="ClassNotebook";n[n.OneNoteAgaves_ClassNotebook=2002]="OneNoteAgaves_ClassNotebook";n[n.OneNoteAgaves_LearningTools=2003]="OneNoteAgaves_LearningTools";n[n.Stickers=2004]="Stickers";n[n.OneNoteAgaves_Stickers=2004]="OneNoteAgaves_Stickers";n[n.Onboarding=2005]="Onboarding";n[n.OneNoteAgaves_Onboarding=2005]="OneNoteAgaves_Onboarding";n[n.AccessibilityChecker=2006]="AccessibilityChecker";n[n.OneNoteAgaves_AccessibilityChecker=2006]="OneNoteAgaves_AccessibilityChecker";n[n.SendToOneNote=2007]="SendToOneNote";n[n.OneNoteAgaves_SendToOneNote=2007]="OneNoteAgaves_SendToOneNote"})(n.ULSCat||(n.ULSCat={}));var t=n.ULSCat}(Diag||(Diag={}));var agaveRunning=!1,dialogHandler,launchTime,isRichApp=!1,wasLaunchedFromMathPane=!1,ltSessionId;Office.initialize=function(){isRichApp=HostingAppPlatforms.isRichPlatform(Office.context.platform);isRichApp&&(Logging.ULS.oneNoteLoggingContext=new OneNote.RequestContext);var n=getQueryParameter("clientlogging")=="false"||!EnableClientSideLogging;Logging.logMode=n?2:1;Logging.ULS.sendTraceTag(20717782,2003,Diag.ULSTraceLevel.info,"UI-less part of Learning Tools Agave loaded");getQueryParameter("autorun")!=null&&launchImmersiveReaderDialog(null)};