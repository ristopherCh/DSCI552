function GetInstrumentationCategory(){return instrumentationCategory?instrumentationCategory:InstrumentationCategoryString?instrumentationCategory=Diag.ULSCat[InstrumentationCategoryString]:null}function InstrumentLinks(n){for(var t,r=0,i=0;i<n.length;i++)t=n[i],t.id||(t.id="un_"+r,r++),t.onclick=GenerateInstrumentationLink(t.id,t.onclick),t.ondragstart=GenerateDragInstrumentationLink(t.id,t.ondrag),t.oncontextmenu=GenerateContextMenuInstrumentationLink(t.id,t.oncontextmenu)}function LogUserViewPortInfo(){var t=$(window).width(),n=$(window).height(),i=screen.width,r=screen.height,u=$(document).height(),f=n/u*100;Diag.ULS.sendTraceTag(6436628,GetInstrumentationCategory(),Diag.ULSTraceLevel.info,"User ViewPort Info;windowWidth={0};windowHeight={1};screenWidth={2};screenHeight={3};percentageOfPageVisible={4};",t,n,i,r,f.toFixed(3))}function UpdateFurthestScrollDepth(){var t=$(window).scrollTop(),i=$(window).height(),r=t+i,u=$(document).height(),n=r/u*100;n>furthestScrollDepthPercentage&&(furthestScrollDepthPercentage=n)}function GenerateInstrumentationLink(n,t){return function(i){var r="";if(i!=null)switch(i.which){case 1:r="Left";break;case 2:r="Middle";break;case 3:r="Right";break;default:r="Unknown"}return(Diag.ULS.sendTraceTag(6160863,GetInstrumentationCategory(),Diag.ULSTraceLevel.info,"User clicked on: {0}, ButtonPressed: {1}",n,r),t)?t(i):!0}}function GenerateContextMenuInstrumentationLink(n,t){return function(i){return(Diag.ULS.sendTraceTag(6160864,GetInstrumentationCategory(),Diag.ULSTraceLevel.info,"User right-clicked on: {0}",n),t)?t(i):!0}}function GenerateDragInstrumentationLink(n,t){return function(i){return(Diag.ULS.sendTraceTag(6160865,GetInstrumentationCategory(),Diag.ULSTraceLevel.info,"User dragged on: {0}",n),t)?t(i):!0}}var approximatePageLoadTime,instrumentationCategory,furthestScrollDepthPercentage=0;window.addEventListener("load",function(){var n=GetInstrumentationCategory(),t;n&&(Diag.ULS.sendTraceTag(6160856,n,Diag.ULSTraceLevel.info,"OnLoad"),Diag.ULS.sendTraceTag(6160857,n,Diag.ULSTraceLevel.info,"UserAgent: {0}",window.navigator.userAgent),InstrumentLinks(document.links),LogUserViewPortInfo(),UpdateFurthestScrollDepth(),t=new Date,approximatePageLoadTime=t.getTime(),Diag.ULS.sendTraceTag(20448734,n,Diag.ULSTraceLevel.info,"Approximate page load time: {0}",t.toISOString()))});window.addEventListener("beforeunload",function(){var n=GetInstrumentationCategory(),t,i;n&&(t=(new Date).getTime(),i=(t-approximatePageLoadTime)/1e3,Diag.ULS.sendTraceTag(6160859,n,Diag.ULSTraceLevel.info,"OnBeforeUnload"),Diag.ULS.sendTraceTag(6436630,n,Diag.ULSTraceLevel.info,"The furthest scrollDepth was ;PercentOfPageViewed={0};",furthestScrollDepthPercentage.toFixed(3)),Diag.ULS.sendTraceTag(6436629,n,Diag.ULSTraceLevel.info,"User time on page ;secondsSpentOnPage={0};",i.toFixed(3)))});window.addEventListener("pageshow",function(){var n=GetInstrumentationCategory();n&&Diag.ULS.sendTraceTag(6160861,n,Diag.ULSTraceLevel.info,"OnPageShow")});window.addEventListener("pagehide",function(){var n=GetInstrumentationCategory();n&&Diag.ULS.sendTraceTag(6160862,n,Diag.ULSTraceLevel.info,"OnPageHide")});window.addEventListener("scroll",function(){var n=GetInstrumentationCategory();n&&UpdateFurthestScrollDepth()});