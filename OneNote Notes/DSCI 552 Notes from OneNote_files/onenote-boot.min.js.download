var Microsoft="object"==typeof Microsoft?Microsoft:{};Microsoft.Office=Microsoft.Office||{},Microsoft.Office.OneNote=function(t){var i={};function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)e.d(n,o,function(i){return t[i]}.bind(null,o));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=29)}({29:function(t,i,e){"use strict";e.r(i);var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(t,i)};var o=function(){return(o=Object.assign||function(t){for(var i,e=1,n=arguments.length;e<n;e++)for(var o in i=arguments[e])Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o]);return t}).apply(this,arguments)};var s,r,a,c=function(){function t(){}return t.prototype.u=function(){},t.prototype.shipAssertTag=function(){},t.prototype.debugAssertTag=function(){},t}();(r=s||(s={}))[r.Error=10]="Error",r[r.Warning=15]="Warning",r[r.Info=50]="Info",r[r.Verbose=100]="Verbose",r[r.Spam=200]="Spam",function(t){t[t.h=0]="msoulscat_ES_EWAJS",t[t.v=1]="msoulscat_ES_EWAJSGrid",t[t.g=6]="msoulscat_ES_EWAJSChart",t[t._=202]="msoulscat_MSOSP_FileMenuCommands",t[t.A=301]="msoulscat_Wac_WordViewer",t[t.U=306]="msoulscat_Wac_BrowserGeneral",t[t.O=320]="msoulscat_Wac_TaskPane",t[t.W=339]="msoulscat_Wac_OneNoteGeneral",t[t.R=340]="msoulscat_Wac_Ribbon",t[t.P=379]="msoulscat_Wac_WopiPendingApplication",t[t.F=383]="msoulscat_Wac_Telemetry",t[t.N=391]="msoulscat_Wac_WacCatchUpActivities",t[t.k=394]="msoulscat_Wac_Dictation",t[t.H=395]="msoulscat_Wac_OneNoteSync",t[t.B=700]="msoulscat_Wac_VisioApp",t[t.J=1601]="msoulscat_OneNoteOnline_EditableCache",t[t.j=800]="msoulscat_Wac_PptAnimation",t[t.q=833]="msoulscat_Wac_PptLive",t[t.$=834]="msoulscat_Wac_PptMWeb",t[t.X=815]="msoulscat_Wac_PptShape",t[t.Z=817]="msoulscat_Wac_PptSession",t[t.Y=830]="msoulscat_Wac_PptSlideshow",t[t.K=2300]="msoulscat_Wac_VersionHistory",t[t.tt=302]="msoulscat_Wac_WordPresence",t[t.et=3005]="msoulscat_Wac_WordVersionHistory",t[t.nt=3006]="msoulscat_Wac_LivePersonaCard",t[t.ot=3012]="msoulscat_Wac_CatchUpFlyout",t[t.st=3021]="msoulscat_Wac_ModernFontPicker"}(a||(a={}));var u;(function(){function t(){}t.tagIntToString=function(i){return i<=t.maxNumericTag?i.toString():i>>24>=this.minOldSchemeHighByteValue?String.fromCharCode(i>>24&255,i>>16&255,i>>8&255,255&i):t.map.charAt(i>>24&63)+t.map.charAt(i>>18&63)+t.map.charAt(i>>12&63)+t.map.charAt(i>>6&63)+t.map.charAt(63&i)},t.getLogMessage=function(i,e,n){return"tag_"+t.tagIntToString(i)+" ["+a[e]+"] "+n},t.prototype.u=function(i,e,n,o){var r=this.logMessage;switch(n){case s.Error:r=this.logError;break;case s.Warning:r=this.logWarning;break;case s.Info:r=this.logInfo;break;case s.Verbose:r=this.logVerbose;break;case s.Spam:default:r=this.logMessage}try{r(t.getLogMessage(i,e,o))}catch(t){var a="undefined"!=typeof navigator?navigator:void 0;if(a&&!/rv:11.0/i.test(a.userAgent))throw t}},t.prototype.shipAssertTag=function(i,e,n,o){console.assert(n,t.getLogMessage(i,e,o))},t.prototype.debugAssertTag=function(t,i,e,n){this.shipAssertTag(t,i,e,n)},t.prototype.logMessage=function(t){"log"in console&&console.log(t)},t.prototype.logError=function(t){"error"in console&&console.error(t)},t.prototype.logWarning=function(t){"warn"in console&&console.warn(t)},t.prototype.logInfo=function(t){"info"in console&&console.info(t)},t.prototype.logVerbose=function(t){"debug"in console&&console.debug(t)},t.maxNumericTag=65535,t.minOldSchemeHighByteValue=36,t.map="abcdefghijklmnopqrstuvwxyz0123456789"})(),new(function(){function t(){this.externalLogger=new c}return t.prototype.setLogger=function(t){this.externalLogger=t},t.prototype.u=function(t,i,e,n){this.externalLogger.u(t,i,e,n)},t.prototype.debugAssertTag=function(t,i,e,n){this.externalLogger.debugAssertTag(t,i,e,n)},t.prototype.shipAssertTag=function(t,i,e,n){this.externalLogger.shipAssertTag(t,i,e,n)},t}());function h(t,i,e){if(""!==i)if(navigator&&navigator.sendBeacon)navigator.sendBeacon(i,t);else{var n=new XMLHttpRequest;n.readyState!==XMLHttpRequest.UNSENT&&n.readyState!==XMLHttpRequest.DONE||(n.open("POST",i,e),n.send(t))}}function f(t,i,e,n){var o=t.map((function(t){return function(t,i){var e={};e.G=t.tag,e.T=t.timestamp-i,e.M=t.message,e.C=t.category;var n=1e3*t.type+t.level;return e.D=n,e}(t,n)})),s=function(t,i,e,n){var o={};return o.T=t,o.L=i,o.S=e,o.I=n,o.V=1,o}(n,o,i,e);return JSON.stringify(s)}!function(t){t[t.Trace=0]="Trace",t[t.Assert=1]="Assert"}(u||(u={}));!function(){function t(i,e){var n=this;this.uploadId=0,this.logCache=[],this.timestampBase=Date.now(),this.userSessionId="00000000-0000-0000-0000-000000000000",this.flushOnClose=function(){n.triggerUpload(!1,!1)},this.flush=function(){n.triggerUploadAsync()},this.triggerUploadAsync=function(){window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)},this.triggerUpload=function(i,e){(window.clearTimeout(n.timeoutId),n.logCache.length>0)&&(n.uploadId+=1,h(f(n.logCache,n.userSessionId,n.uploadId,n.timestampBase),n.remoteUrlEndpoint,e),n.logCache=[],n.timestampBase=Date.now());i&&(n.timeoutId=window.setTimeout(n.triggerUploadAsync,t.uploadCadenceInMsSec))},this.userSessionId=i,this.remoteUrlEndpoint=e+"?usid="+i,window.setTimeout((function(){return n.triggerUpload(!0,!0)}),0)}t.prototype.handleTrace=function(i){i.message.length>t.messageMaxChars&&(i.message=i.message.substr(0,t.messageMaxChars-t.trimmedMessage.length)+t.trimmedMessage),this.logCache.push(i),(this.logCache.length>t.uploadTriggerSize||i.level===s.Error)&&this.triggerUploadAsync()},t.messageMaxChars=3072,t.uploadCadenceInMsSec=3e4,t.uploadTriggerSize=30,t.trimmedMessage="... [Trimmed]"}();s.Info;var d;!function(t){function i(){return null!==t&&t.apply(this,arguments)||this}(function(t,i){function e(){this.constructor=t}n(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)})(i,t)}(c);function l(){if(null!=navigator&&null!=navigator.userAgent){var t=navigator.userAgent;if(t.indexOf("Firefox")>-1)return d.Firefox;if(t.indexOf("Opera")>-1)return d.Opera;if(t.indexOf("Trident")>-1)return d.IE;if(t.indexOf("Edge")>-1)return d.Edge;if(t.indexOf("Chrome")>-1)return d.Chrome;if(t.indexOf("Safari")>-1)return d.Safari}return d.Unknown}function p(){try{return navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("Macintosh")>=0&&g()&&!(navigator.userAgent.indexOf("iPhone")>=0)||navigator.userAgent.indexOf("Android")>=0||g()}catch(t){return!1}}function m(){try{return window.matchMedia("screen and (-ms-high-contrast: active)").matches}catch(t){return!1}}function v(){return l()===d.IE&&!function(){if(l()!==d.IE)return!1;if(null==document.documentMode||void 0===document.documentMode)return!1;return document.documentMode>=11}()}function w(){try{return window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")}catch(t){return!1}}function g(){return navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}!function(t){t[t.Firefox=0]="Firefox",t[t.Opera=1]="Opera",t[t.IE=2]="IE",t[t.Edge=3]="Edge",t[t.Chrome=4]="Chrome",t[t.Safari=5]="Safari",t[t.Unknown=6]="Unknown"}(d||(d={}));function S(t){return 8===t.toLowerCase().indexOf("ffc")}function _(t){return 8===t.toLowerCase().indexOf("ppc")}function I(t){var i=t.match(/^https:\/\/((?!word)\w+)(-\w+)+\..*$/i);return i&&i[1]?i[1]:"public"}function b(t){var i=t.match(/^(.*?\/\/[^\/]+)(.*)$/);if(!i)throw new Error("Invalid URL");return i[1]}function C(t,i){var e=t.match(/^(.*?\/\/)([^\/:]+)(.*)$/);if(!e)throw new Error("Invalid URL");var n=e[2];if(void 0===i)return n;if(i<0)throw new Error("subDomainParts should be at least 1");return n.split(".").slice(-(i+1)).join(".")}function A(t,i,e){e&&(t[i.toLowerCase()]=e)}function y(t,i){var e=t.indexOf("&"+i+"=");if(-1===e&&(e=t.indexOf("?"+i+"=")),-1===e)return"";var n=e+(i.length+2),o=t.indexOf("&",n);return t.substring(n,-1===o?void 0:o)}function T(t,i,e,n){if(void 0===n&&(n=!1),!e)return t;var o=t,s=o.indexOf("?"),r="&";s===o.length-1||"&"===o.slice(-1)||"&>"===o.slice(-2)?r="":-1===s&&(r="?");var a=i.toLowerCase()+"=",c=o.toLowerCase().indexOf(a,s);if("?"!==r&&c>=0){if(n){var u=o.indexOf("&",c);o=o.substring(0,c)+a+e+(-1===u?"":o.substring(u))}return o}return o.concat(r,a,e)}function U(t){if(!t)return"";var i=-1===t.indexOf("#")?t.length:t.indexOf("#"),e=t.lastIndexOf("/",i);if(-1!==e&&e+1===t.indexOf("://")+"://".length)return"";e+=1;var n=t.indexOf("?");if(-1!==(n=n>=i?-1:n)&&e>n)return"";var o=-1===n?i:n;return e>=o?"":t.substring(e,o)}var O,W=(O=l())===d.Firefox||O===d.IE?"prefetch":"preload";var E={en:"1033",cs:"1029",da:"1030",de:"1031",el:"1032",fi:"1035",fr:"1036",hu:"1038",it:"1040",ja:"1041",ko:"1042",nl:"1043",nb:"1044",sk:"1051",sv:"1053",tr:"1055",uk:"1058",sl:"1060",es:"3082",pl:"1045",ro:"1048",ru:"1049"};var R= "16.0.13602.41001";function P(){return R}function F(){return function(t){if(!t)throw new Error("Build number not available");var i=t.split(".");if(4!==i.length)throw new Error("Build number has incorrect format");return i[0]+i[2]+i[3]}(P())}var N,x,k,M,H,D=function(){try{var t=window.performance;return t&&t.now&&t.now()!==1/0}catch(t){return!1}}();function B(){return D?window.performance.now():Date.now()}function J(){if(!N){var t=window.performance;N=D&&t.timing&&t.timing.navigationStart?function(){return Math.round(t.now()+t.timing.navigationStart)}:Date.now?Date.now:function(){return(new Date).getTime()}}return N()}function L(t){return JSON.stringify(t,Object.getOwnPropertyNames(t))}function j(t,i){try{if(void 0===window.performance)return void i.ULS.u(595948609,a.P,s.Info,"Performance not supported");var e=window.performance.getEntriesByType("resource");if(void 0===e||e.length<=0)return void i.ULS.u(595948610,a.P,s.Info,"No resources under performance");for(var n=new RegExp(t+"(-boot.min|(.(app|preview))?.boot).js","i"),o=e.length-1;o>=0;o-=1){var r=e[o],c=r.name.match(n);if(c){var u=JSON.stringify(r);return u=u.replace(new RegExp(r.name,"g"),c[0]),void i.ULS.u(595948616,a.P,s.Info,u)}}i.ULS.u(595948484,a.P,s.Info,"Could not find JSAPI resource timing entry")}catch(t){i.ULS.u(595948617,a.P,s.Info,"Could not trace the resource timing: "+L(t))}}function V(){var t={perfNowSupported:D,browser:d[l()],touchMode:p(),highContrast:m(),windows10x:w()};try{var i=window.navigator,e=i.connection||i.mozConnection||i.webkitConnection;e&&(t.netDownlink=e.downlink,t.netDownlinkMax=e.downlinkMax,t.netEffectiveType=e.effectiveType,t.netRtt=e.rtt,t.netSaveData=e.saveData,t.netType=e.type),t.deviceMemory=i.deviceMemory,t.logicalProcessors=i.hardwareConcurrency}catch(t){}return t}function z(t,i,e){t.ULS.u(595957843,a.P,s.Info,"Page lifecycle: "+i+" fired"+(e?", flushing logger":"")),e&&t.ULS.flush()}!function(t){t.rt="BootstrapperMaxUlsHeartbeatTime",t.at="BootstrapperNoCompleteWarning1Time",t.ct="BootstrapperNoCompleteWarning2Time",t.ut="RemoteUlsETag",t.ht="RemoteUlsSuppressions",t.ft="BootstrapperSettingsFetchPeriod",t.dt="timestamp",t.lt="BootstrapperUlsHeartbeatIntervalMs",t.pt="BootstrapperUlsHeartBeatIsEnabled",t.vt="BootstrapperUlsUploadCadenceMs",t.wt="WordConsumptionViewToEditRedirectIsEnabled"}(x||(x={}));var G,q;function $(){q&&(window.clearInterval(q),q=void 0)}function X(){var t=new Uint8Array(31),i=function(t){var i={crypto:!1,perfNow:!1,exceptions:[]},e=window.crypto||window.msCrypto;if(e){i.crypto=!0;try{return e.getRandomValues(t),i}catch(t){i.exceptions.push("crypto: "+L(t))}}i.perfNow=D;for(var n=0;n<t.length;n+=1){try{if(D){var o=Math.floor(100*window.performance.now())%10;(o<0||o>9)&&(o=0);for(var s=0;s<o;s+=1)Math.random()}}catch(t){i.exceptions.push("Math.random: "+L(t))}t[n]=Math.floor(16*Math.random())}return i}(t),e=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(i){var n=15&t[e];return e+=1,("x"===i?n:3&n|8).toString(16)})),i]}var Z,Y=function(){function t(t){var i=this;this.gt=3e4,this.St=30,this._t=0,this.It=[],this.bt=J(),this.Ct="",this.At=0,this.flushOnClose=function(){i.yt(!1,!1)},this.flush=function(){i.Tt()},this.Tt=function(){window.setTimeout((function(){return i.yt(!0,!0)}),0)},this.yt=function(t,e){var n=B();if(window.clearTimeout(i.Ut),i.Ot){if(i.It.length>0)i._t+=1,h(f(i.It.splice(0,t?i.St:i.It.length),i.Ct,i._t,i.bt),i.Ot,e),i.bt=J();t&&(i.Ut=window.setTimeout(i.Tt,i.It.length>i.St?1e3:i.gt)),i.At+=B()-n}},t&&this.configure(t)}return t.prototype.getTimeSpentLogging=function(){return this.At},t.prototype.addLoggingTime=function(t){this.At+=t},t.prototype.configure=function(t){var i=this,e=B();if(t.uploadCadenceInMs&&(this.gt=t.uploadCadenceInMs),t.uploadTriggerSize&&(this.St=t.uploadTriggerSize),t.sessionId&&(this.Ct=t.sessionId),t.remoteUlsEndpoint){if(!t.sessionId&&this.Ot)throw new Error("Remote ULS endpoint is already set");this.Ot=t.remoteUlsEndpoint+"?usid="+this.Ct,this.bt=J(),window.setTimeout((function(){return i.yt(!0,!0)}),0)}this.At+=B()-e},t.prototype.handleTrace=function(t){var i=B();t.message.length>3072&&(t.message=t.message.substring(0,3072-"... [Trimmed]".length)+"... [Trimmed]"),this.It.push(t),(this.It.length>this.St||t.level===s.Error)&&this.Tt(),this.At+=B()-i},t}(),K=[];var Q,tt,it,et,nt;function ot(t){var i=new Y(t);function e(t,e,n,o){var s=B();if(!function(t){return 1===K[t]}(t)){var r={timestamp:J(),category:e,tag:t,level:n,type:u.Trace,message:o};i.addLoggingTime(B()-s),i.handleTrace(r)}}return{ULS:{u:function(t,i,n,o){e(t,i,n,o)},shipAssertTag:function(t,i,n,o){n&&e(t,i,s.Error,o)},debugAssertTag:function(t,i,e,n){throw new Error("Debug Asserts not Implemented in the TypeScript bULS module")},flush:i.flush,flushOnClose:i.flushOnClose},configure:function(t){i.configure(t)},settingsChangeHandler:function(t){var e,n;e=t.Wt.getValue(x.ht,""),n=t.Wt.getValue(x.ut,""),Z&&n===Z||(K=[],Z=n,e&&e.split(",").forEach((function(t){var i=parseInt(t,10);i&&(K[i]=1)}))),i.configure({uploadCadenceInMs:t.Wt.getValue(x.vt,6e4)})},getTimeSpentLogging:function(){return i.getTimeSpentLogging()}}}function st(t){var i=t.match(/^(.*?\/\/[^\/]+\/[^\/]+\/)(.*)$/);if(!i)throw new Error("Invalid URL");return i[1]}function rt(t,i){i&&i.Diagnostics&&Object.keys(i.Diagnostics).forEach((function(e){return t[e]=i.Diagnostics[e]}))}function at(t,i,e){i.ULS.u(596459999,a.P,e,"SessionTraces: "+JSON.stringify(t))}function ct(t,i){i.Stop();var e=i.GetVisibilityChangeEvents();null!=e&&e.length>0&&(t.AppInitDiagnostics.documentLoadedWithTabSwitch=!0,t.SessionTraces.tabSwitchDiagnostics=JSON.stringify(e)),i.Dispose()}function ut(t,i,e){try{var n=function(t,i){var e=o({},i);delete e.UserId,delete e.OwnerId,delete e.WdParams;var n=e,s=i.WdParams?JSON.parse(JSON.stringify(i.WdParams).toLowerCase()):{};return n.WdParams={},["wdorigin","wdpreviouscorrelation","wdprevioussession","wdtf"].forEach((function(t){s[t]&&(n.WdParams[t]=s[t])})),n.UiEmbedMode=t.toLowerCase().indexOf("uiembed=1")>=0,n.UiHostName=y(t,"uih")||"N/A",n.HostDomain=location?location.hostname:"",n}(i.applicationUrl,i.sessionInformation);n.Build=P(),n.Region=I(i.applicationUrl);var r=o({},i.rebootOverrideData);delete r.ackExpected,delete r["ui-language"],delete r.wdUserSession,delete r.rebootMode,delete r.documentUrl,n.RebootOverride=r,i.diagnostics.HostInitDiagnostics&&(t.ULS.u(596444238,a.P,s.Info,"HostInitDiagnostics: "+JSON.stringify(i.diagnostics.HostInitDiagnostics)),n.SessionOrigin=i.diagnostics.HostInitDiagnostics.entryPoint),e&&t.ULS.u(595937313,a.P,s.Info,JSON.stringify(e));var c=i.wopiInfo;c&&c.AccessToken&&c.AccessTokenExpiry||t.ULS.u(595894553,a.P,s.Warning,"There are some missing parameters"),c&&(c.AccessToken&&(n.AccessTokenLength=c.AccessToken.length),n.AccessTokenExpiry=c.AccessTokenExpiry);n.JsApiVersion=i.featureManager.isFeatureEnabled("")?"v1Wrapper":"v1",t.ULS.u(596444237,a.P,s.Info,JSON.stringify({session:n,client:V()}))}catch(i){t.ULS.u(590915460,a.P,s.Error,"Failed to log initialization info: "+L(i))}}!function(t){t.Et="App_AccessibilityLoopComplete",t.Rt="WacInitialize_Ready",t.Pt="Wac_AppFailed",t.Ft="Wac_AppBootState",t.Nt="Wac_AppCompleted",t.xt="BrowserEvent",t.kt="UI_Close",t.Mt="App_CloseTab",t.Ht="UI_Conversation",t.Dt="UI_CopyAndEdit",t.Bt="App_CreateNewDocument",t.Jt="Wac_AppDataSavedStatus",t.Lt="UI_Download",t.jt="UI_Edit",t.Vt="Error",t.zt="UI_FileEmbed",t.Gt="UI_FileProperties",t.qt="File_Rename",t.$t="File_RenameFailed",t.Xt="UI_FileVersions",t.Zt="StateChanged",t.Yt="App_IsFrameTrusted",t.Kt="GetAccessToken",t.Qt="App_GetAuthToken",t.ti="App_GetCustomAuthConfig",t.ii="App_WopiInfoFromUrl",t.ei="App_LoadingStatus",t.ni="App_SwitchMode",t.oi="UI_OpenInBrowser",t.si="UI_OpenInClient",t.ri="PageChanged",t.ai="App_PushCommentContext",t.ci="App_PushState",t.hi="App_DocReboot",t.di="UI_RedeemForCommenting",t.li="App_RefreshSessionInfo",t.pi="UI_ReplyWithChanges",t.mi="UI_ReportAbuse",t.vi="UI_SaveStatus",t.wi="WopiSession_Complete_Ack",t.gi="SetOverlayContent",t.Si="UI_Sharing",t._i="UI_ShareForm",t.Ii="UI_SignIn",t.bi="App_Unloaded",t.Ci="Wac_UnloadingApp",t.Ai="PageCount",t.yi="UI_CheckUserAccessAndGrantPermissions",t.Ti="User_Activity",t.Ui="Edit_Notification",t.Oi="UI_Workflow",t.Wi="ZoomChanged"}(Q||(Q={})),function(t){t.Ei="Ack",t.Ri="WacInitialize_Ready_Ack",t.Pi="Wac_BeforeUnloadApp",t.Fi="Blur_Focus",t.Ni="Wac_AppFailed_Ack",t.xi="Wac_AppCompleted_Ack",t.ki="WopiStartSession_Complete",t.Mi="WopiPendingSession_Complete",t.Hi="Host_AccessibilityLoopComplete",t.Yt="Host_IsFrameTrusted",t.Di="Grab_Focus",t.Bi="HostCacheDiagnostic",t.Ji="JsApiDiagnostics",t.Li="PageChanged_Ack",t.ji="App_PopState",t.Vi="Host_PostmessageReady",t.zi="File_Rename",t.Gi="PostAccessToken",t.qi="Host_SetAuthToken",t.$i="Host_SetCustomAuthConfig",t.Xi="App_PushCommentContext",t.Zi="CanEmbed",t.Yi="Host_RefreshSessionInfo",t.Ki="CheckUserAccessAndGrantPermissions_Result",t.Qi="Host_WopiInfoFromUrl",t.te="SetCurrentPage",t.ie="SetZoomLevel",t.ee="WopiPendingSession_Fail",t.ne="SetOverlayContent",t.oe="WopiPendingApplicationComplete_Received",t.se="Host_SwitchMode",t.re="Host_Unload",t.ae="PageCount_Ack",t.ce="ZoomChanged_Ack"}(tt||(tt={})),function(t){t.ue="EnterpriseTemplates",t.he="ExcelAdaptiveLayoutDownload",t.fe="ExcelJsApiV2",t.le="ExcelJsApiV2NoWrapper",t.pe="ExcelLandingPageOfflineTelemetry",t.me="ExcelLandingPageObserverRetry",t.ve="H2StaticContent",t.we="HashedUrl",t.ge="ODCShareLinkPreload",t.Se="OfficeComExcelJsApiV2",t._e="OfficeComUiHost",t.Ie="OfficeComWordJsApiV2",t.be="OfficeHwaUiHost",t.Ce="WordJsApiV2",t.Ae="WordJsApiV2NoWrapper",t.ye="WordViewToUnifiedRead"}(it||(it={})),function(t){t.Unknown="Unknown",t.AppInitError="AppInitError",t.ApiDisabledError="ApiDisabledError",t.CannotLoadFirstPage="CannotLoadFirstPage",t.CannotLoadScript="CannotLoadScript",t.PageChangeError="PageChangeError",t.ZoomChangeError="ZoomChangeError",t.CannotLoadBundleItem="CannotLoadBundleItem",t.InvalidPageIndex="InvalidPageIndex",t.UnsupportedBundleVersion="UnsupportedBundleVersion",t.InvalidWopiInfo="InvalidWopiInfo",t.TimeoutWacReady="TimeoutWacReady",t.WacFailed="WacFailed"}(et||(et={})),function(t){t.Te="access_token",t.Ue="access_token_ttl",t.Oe="bundleSrc",t.We="bundleStaleness",t.Ee="DocID",t.Re="ETag",t.Pe="feature_status",t.Fe="fileExtension",t.Ne="fileGetUrl",t.xe="fileName",t.ke="fileSize",t.Me="forceSLR",t.He="frameHeightPx",t.De="frameWidthtPx",t.Be="highContrast",t.Je="highDpi",t.Le="host_diagnostics",t.je="hostName",t.Ve="huictrls",t.ze="owner_id",t.Ge="sc",t.qe="softBlockedBrowser",t.$e="templateUrl",t.Xe="touchMode",t.Ze="user_id"}(nt||(nt={}));function ht(t){if("undefined"!=typeof navigator&&navigator.virtualKeyboard&&void 0!==navigator.virtualKeyboard.overlaysContent&&window===top)return navigator.virtualKeyboard.overlaysContent=t}var ft;function dt(t,i,e){void 0===e&&(e=!1);var n=t.applicationUrl;var s={jsApi:"1"};if(s.jsapiver=t.featureManager.isFeatureEnabled("")?"v1Wrapper":"v1",e&&(s.NewSession="1"),s.corrid=t.sessionId,s.usid=t.sessionId,s.sftc="1",(t.applicationCustomSettings&&t.applicationCustomSettings.IsCore||t.sessionInformation.IsCore)&&(s.core="1"),t.sessionInformation.HideViewerToolbar&&(s.hvt="1"),t.sessionInformation.DisableFocusOnBoot&&(s.disableFocusOnBoot="1"),t.sessionInformation.HighContrastMode&&(s.hcm=encodeURIComponent(t.sessionInformation.HighContrastMode)),t.sessionInformation.SupportsAtMentions&&(s.sams="1"),t.sessionInformation.SupportsAccessibilityLoop&&(s.accloop="1"),t.sessionInformation.SupportsDocReboot){var r=t.sessionInformation.SupportsDocReboot;s.sdr=!0===r?"1":r.toString()}return t.sessionInformation.SupportsCreateNewDocument&&(s.scnd="1"),t.sessionInformation.SupportsAuthToken&&(s.sat="1"),t.sessionInformation.SupportsCustomAuthConfig&&(s.cac="1"),t.sessionInformation.SupportsMoveToFolder&&(s.mtf="1"),t.sessionInformation.HideHeader&&(s.hhdr="1"),t.sessionInformation.HideBreadCrumbInViewer&&(s.hbcv="1"),t.sessionInformation.HideTitleInViewer&&(s.htv="1"),t.sessionInformation.HideWACOneDriveFileLocationPicker&&(s.hodflp="1"),t.applicationCustomSettings&&t.applicationCustomSettings.FixDiagnosticsJson&&(s.fixdiag="1"),(t.wopiPrecheckInfo.ReadOnly||i.bootFlowType===ft.wordViewToUnifiedReadRedirect)&&(s.readOnly="1"),i.bootFlowType===ft.wordViewToUnifiedReadRedirect&&(s.cons="1"),t.sessionInformation.UIEmbed&&(s.uiEmbed="1"),t.sessionInformation.UiHostIntegrationType&&(s.uihit=encodeURIComponent(t.sessionInformation.UiHostIntegrationType)),t.sessionInformation.MetaUiHostVersion&&(s.muv=encodeURIComponent(t.sessionInformation.MetaUiHostVersion)),t.applicationCustomSettings&&t.applicationCustomSettings.InAppDocumentPreview&&(s.InAppDocPreview="1"),i.isSingleStepBoot?(i.bootFlowType===ft.unifiedSingleFlush&&(t.isCreateNew||(s.instantedit="1",s.wopicomplete="1")),s.wdRedirectionReason=i.bootFlowType):(s.instantedit="1",s.fileSrc=encodeURIComponent(t.sessionInformation.HostName),s.pmOrigin=encodeURIComponent(b(window.location.href)),t.isCreateNew&&(s.new="1",t.wopiPrecheckInfo.IsNewFileFromHostTemplate&&(s.wdTpl="fromhost"))),t.wopiPrecheckInfo.PreseededSessionKey&&(s.preseededSessionKey=encodeURIComponent(t.wopiPrecheckInfo.PreseededSessionKey)),t.wopiPrecheckInfo.PreseededWacSessionId&&(s.preseededWacSessionId=encodeURIComponent(t.wopiPrecheckInfo.PreseededWacSessionId)),t.wopiPrecheckInfo.RequestedCallThrottling&&(s.rct=t.wopiPrecheckInfo.RequestedCallThrottling),t.wopiPrecheckInfo.ClientThrottlingProtection&&(s.ctp=t.wopiPrecheckInfo.ClientThrottlingProtection),t.applicationCustomSettings&&t.applicationCustomSettings.additionalApplicationParameters&&(s=o(o({},t.applicationCustomSettings.additionalApplicationParameters),s)),t.rebootOverrideData&&t.rebootOverrideData.queryOverrides&&(s=o(o({},s),t.rebootOverrideData.queryOverrides)),function(t,i,e,n,s){var r=function(t){var i={},e=t.indexOf("?");return-1===e||e===t.length-1||t.substring(e+1).replace(new RegExp(/<.*?>/g),"").split("&").forEach((function(t){if(t){var e=t.indexOf("=");-1!==e&&e!==t.length-1&&(i[t.substring(0,e).toLowerCase()]=t.substring(e+1))}})),i}(t);"teams"!==r.uih&&"owa"!==r.uih||(r.hhdr="1");var a=t.indexOf("?"),c=-1===a?t.concat("?"):t.substring(0,a+1);i.UiLocale&&(r.ui=encodeURIComponent(i.UiLocale));i.DataLocale&&(r.rs=encodeURIComponent(i.DataLocale));i.HostSessionId&&(r.hid=encodeURIComponent(i.HostSessionId));i.DisableChat&&(r.dchat="1");i.SessionContext&&(r.sc=encodeURIComponent(i.SessionContext));e&&e.WopiSrc&&(r.wopisrc=encodeURIComponent(e.WopiSrc));i.CookieCompliant&&(r.mscc="1");n&&(n.entryPoint&&(r.wdorigin=encodeURI(n.entryPoint)),n.userClickTime&&(r.wdhostclicktime=n.userClickTime.toString()));r=o(o(o({},r),i.WdParams),s);var u={};for(var h in r)u[h.toLowerCase()]=r[h];var f=[];for(var h in u)u[h]&&f.push(h.concat("=",u[h]));return c.concat(f.join("&"))}(n,t.sessionInformation,t.wopiInfo,t.diagnostics.HostInitDiagnostics,s)}function lt(t){return t.AccessTokenExpiry?t.AccessTokenExpiry.getTime().toString():"0"}function pt(t,i){return{isFeatureEnabled:function(e){return function(t,i,e){if(!i)return;try{return i(t)}catch(t){e&&e.ULS.u(594883024,a.P,s.Error,"IsFeatureEnabled callback error: "+L(t))}return}(e,t,i)}}}!function(t){t.bootWithoutWopiInfo="",t.unifiedSingleFlush="Unified_SingleFlush",t.unifiedIrmEnabled="Unified_IrmEnabled",t.unifiedViewActionUrl="Unified_ViewActionUrl",t.unifiedNotEditOrViewActionUrl="Unified_NotEditOrViewActionUrl",t.forceSingleStepBoot="Force_SingleStepBoot",t.wordUiEmbedReadOnlyEarlyRedirect="WordUiEmbed_ReadOnlyEarlyRedirect",t.wordUiEmbedIrmEnabledEarlyRedirect="WordUiEmbed_IrmEnabledEarlyRedirect",t.wordViewToUnifiedReadRedirect="WordView_UnifiedReadRedirect"}(ft||(ft={}));function mt(t,i,e,n,o,s,r){return function(t,i,e,n){!function(t,i){A(i,nt.He,String(t.offsetHeight)),A(i,nt.De,String(t.offsetWidth)),A(i,nt.Xe,String(p())),A(i,nt.Be,String(m())),A(i,nt.Me,String(w()))}(t,n);var o=i.ownerDocument,s=o.createElement("form");for(var r in s.id="office_form",s.name="office_form",s.action=e,s.target=t.name,s.method="POST",n){var a=o.createElement("input");a.type="hidden",a.name=r,a.value=n[r],s.appendChild(a)}return i.appendChild(s),s.submit(),t}(function(t,i,e,n){var o=t.ownerDocument.createElement("iframe");o.name=e||"WebApplicationFrame",o.id="WebApplicationFrame",o.src="",o.title="Office Online Frame",o.width="100%",o.height="100%",o.marginWidth="0",o.marginHeight="0",o.style.left="0",o.style.top="0",o.style.right="0",o.style.bottom="0",o.style.display="block",o.style.position="absolute",o.style.backgroundColor="transparent",o.style.border="none",o.frameBorder="0",o.setAttribute("allowfullscreen","true"),o.setAttribute("allowTransparency","true");var s=b(i);return o.setAttribute("allow","microphone "+s+"; camera "+s+";"),n&&(o.onload=n),t.appendChild(o),o}(t,i,o),t,i,e)}function vt(t,i){var e={};if(t.wopiInfo&&(e[nt.Te]=t.wopiInfo.AccessToken,e[nt.Ue]=lt(t.wopiInfo)),t.wopiPrecheckInfo.BundleInfo&&t.wopiPrecheckInfo.BundleInfo.Url&&t.wopiPrecheckInfo.BundleInfo.Url.length>0)if(e[nt.Oe]=t.wopiPrecheckInfo.BundleInfo.Url,null!=t.wopiPrecheckInfo.BundleInfo.BundleStaleness&&void 0!==t.wopiPrecheckInfo.BundleInfo.BundleStaleness){var n=t.wopiPrecheckInfo.BundleInfo.BundleStaleness.toString();i.ULS.u(593503580,a.P,s.Info,"Content bundle staleness - "+n),e[nt.We]=n}else i.ULS.u(593503581,a.P,s.Info,"Content bundle staleness does not exist");if(t.wopiPrecheckInfo.FileGetUrl&&(e[nt.Ne]=t.wopiPrecheckInfo.FileGetUrl),t.wopiPrecheckInfo.FileName){var o=t.wopiPrecheckInfo.FileName.lastIndexOf(".");if(-1!==o){var r=t.wopiPrecheckInfo.FileName.substring(o+1);r&&(e[nt.Fe]=r)}e[nt.xe]=t.wopiPrecheckInfo.FileName}return t.newFileTemplateSource&&t.newFileTemplateSource.FileSize?e[nt.ke]=t.newFileTemplateSource.FileSize.toString():t.wopiPrecheckInfo.FileSize&&(e[nt.ke]=t.wopiPrecheckInfo.FileSize.toString()),t.sessionInformation.UserId&&(e[nt.Ze]=t.sessionInformation.UserId),t.sessionInformation.OwnerId&&(e[nt.ze]=t.sessionInformation.OwnerId),t.sessionInformation.SessionContext&&(e[nt.Ge]=t.sessionInformation.SessionContext),t.diagnostics.HostInitDiagnostics&&(e[nt.Le]=JSON.stringify({HostInitializeDiagnostics:t.diagnostics.HostInitDiagnostics})),e[nt.Pe]=function(t,i){var e={};if(Object.keys(it).forEach((function(i){var n=t.isFeatureEnabled(it[i]);void 0!==n&&(e[it[i]]=n?"1":"0")})),i&&i.wdFlights)for(var n=0,o=i.wdFlights.toLowerCase().split(",");n<o.length;n++){var s=o[n];"et-treatment"!==s&&"et-control"!==s||(e[it.ue]="et-treatment"===s?"1":"0")}return JSON.stringify(e)}(t.featureManager,t.sessionInformation.WdParams),t.applicationCustomSettings&&t.applicationCustomSettings.HostUIControls&&(e[nt.Ve]=JSON.stringify(t.applicationCustomSettings.HostUIControls)),e[nt.Je]=String(window.devicePixelRatio>1.24),e[nt.qe]=String(v()),e[nt.je]=t.sessionInformation.HostName,t.newFileTemplateSource&&(e[nt.$e]=t.newFileTemplateSource.FileGetUrl),t.newFileTemplateSource&&t.newFileTemplateSource.DocUniqueId?e[nt.Ee]=t.newFileTemplateSource.DocUniqueId:t.wopiPrecheckInfo.DocUniqueId&&(e[nt.Ee]=t.wopiPrecheckInfo.DocUniqueId),t.newFileTemplateSource&&t.newFileTemplateSource.ETag?e[nt.Re]=t.newFileTemplateSource.ETag:t.wopiPrecheckInfo.ETag&&(e[nt.Re]=t.wopiPrecheckInfo.ETag),e}var wt=function(){function t(t,i,e,n,o,r){var c=this;if(this.Ye=!1,this.Ke=[],this.logWarningOnNoAppComplete=function(t){c.Ye||function(t,i){t.ULS.u(594901218,a.P,s.Warning,"Boot_NotComplete_"+(i||"Final")),t.ULS.flush()}(c.Qe,t)},void 0===i)throw new TypeError("bootFlowInfo");if(i.isSingleStepBoot&&void 0===t.wopiInfo)throw new TypeError("wopiInfo");this.tn=t,this.in=i,this.Qe=e,this.nn=n,this.on=o,this.sn=r,this.rn=t.diagnostics.AppInitDiagnostics,this.an=t.diagnostics.SessionTraces,this.an.wopiInitializeTime=J()}return t.prototype.Boot=function(){var t=this;this.Qe.ULS.u(596444241,a.P,s.Info,"Initializing WAC frame");var i=dt(this.tn,this.in,!0),e=vt(this.tn,this.Qe);if(function(t,i,e,n){if(i.getValue(x.pt,!1)){G=B();var o=t?3e3:5e3;q=window.setInterval((function(){e.ULS.u(595724178,a.P,s.Info,"Boot_HeartBeat"),B()-G>i.getValue(x.rt,3e5)&&($(),n&&n())}),i.getValue(x.lt,o))}}(S(i),this.tn.Wt,this.Qe,this.logWarningOnNoAppComplete),this.nn.registerMessagePayloadHandler(Q.Ft,(function(i){t.handleWacAppBootState(i)})),this.nn.registerMessagePayloadHandler(Q.Mt,(function(){t.handleCloseTab()})),this.nn.registerMessagePayloadHandler(Q.Yt,(function(i){t.handleTrustFrameRequest(i)})),this.nn.registerMessagePayloadHandler(Q.gi,(function(i){t.handleSetOverlayContent(i)})),this.in.ignoreWacFramePostMessages||this.populateWacFrameCompletedAndFailedHandlers(),this.bootWacFrame(i,e),this.in.ignoreWacFramePostMessages){var n=this.getApplicationState();this.on(n)}return this.Qe.ULS.u(595661019,a.P,s.Info,"Created Wac Frame"),this.cn},t.prototype.bootWacFrame=function(t,i){this.rn.officeFrameCreateTime=J(),this.an.frameCreateStartTime=this.rn.officeFrameCreateTime;var e=this.tn.applicationCustomSettings&&this.tn.applicationCustomSettings.appFrameName;this.cn=mt(this.tn.container,t,i,this.tn.featureManager,e,this.Qe,this.tn.sessionId),this.nn.activate(this.cn)},t.prototype.populateWacFrameCompletedAndFailedHandlers=function(){var t=this;this.nn.registerMessagePayloadHandler(Q.Nt,(function(i){t.handleWacCompleteMessage(i)})),this.nn.registerMessagePayloadHandler(Q.Pt,(function(i){t.handleWacFailureMessage(i)})),this.Ke.push(window.setTimeout((function(){return t.timeoutWacAppCompleteOrFail()}),15e3)),this.Ke.push(window.setTimeout((function(){return t.logWarningOnNoAppComplete(1)}),this.tn.Wt.getValue(x.at,6e4))),this.Ke.push(window.setTimeout((function(){return t.logWarningOnNoAppComplete(2)}),this.tn.Wt.getValue(x.ct,18e4)))},t.prototype.handleWacAppBootState=function(t){var i=t&&t.state?t.state:"unknown";this.Qe.ULS.u(595714271,a.P,s.Info,"WAC Boot App state:["+i+"]")},t.prototype.handleTrustFrameRequest=function(t){var i=function(t){try{return window===window.top||window.parent===window.top&&window.location.origin===window.top.origin}catch(i){return t&&t.ULS.u(591525084,a.P,s.Info,"Trust check error: "+L(i)),!1}}(this.Qe);this.Qe.ULS.u(595653903,a.P,s.Info,"Top frame is trusted: "+i),this.nn.sendPostMessage(this.cn.contentWindow,tt.Yt,{isTopFrameTrusted:i})},t.prototype.handleSetOverlayContent=function(t){var i=ht(t&&t.overlayContent);this.Qe.ULS.u(587487432,a.P,s.Info,"Overlay content: "+i),this.nn.sendPostMessage(this.cn.contentWindow,tt.ne,void 0)},t.prototype.handleWacCompleteMessage=function(t){if(this.Qe.ULS.u(595986314,a.P,s.Info,"Received wac complete message"),this.Qe.ULS.flush(),$(),this.clearLogTimers(),this.Ye)this.Qe.ULS.u(596444234,a.P,s.Info,"Received multiple wac complete or failure messages");else{this.Ye=!0,this.sendWacPostMessage(tt.xi,{}),rt(this.rn,t);var i=this.getApplicationState();this.on(i),this.sendJsApiDiagnosticsToWacFrame(this.tn.diagnostics)}},t.prototype.handleCloseTab=function(){this.Qe.ULS.u(579342464,a.P,s.Info,"Received close tab message");try{window.close()}catch(t){this.Qe.ULS.u(579213188,a.P,s.Warning,"Failed to close the browser tab")}},t.prototype.getApplicationState=function(){return{innerApplicationFrame:this.cn}},t.prototype.handleWacFailureMessage=function(t){if(this.Qe.ULS.u(595986315,a.P,s.Error,"Received wac failed message"),this.Qe.ULS.flush(),$(),this.clearLogTimers(),this.Ye)this.Qe.ULS.u(596444235,a.P,s.Info,"Received multiple wac complete or failure messages");else{this.Ye=!0,this.sendWacPostMessage(tt.Ni,{});var i={errorType:et.WacFailed,errorObject:{}};t&&(i.errorObject=t.Error,this.an.error=i),this.sn(i)}},t.prototype.timeoutWacAppCompleteOrFail=function(){this.Ye||this.Qe.ULS.u(596444236,a.P,s.Warning,"Timeout. SessionTraces:"+JSON.stringify(this.an))},t.prototype.clearLogTimers=function(){!function(t){for(var i=0;i<t.length;i+=1)t[i]&&window.clearTimeout(t[i])}(this.Ke),this.Ke=[]},t.prototype.sendJsApiDiagnosticsToWacFrame=function(t){this.sendWacPostMessage(tt.Ji,{HostInitializeDiagnostics:t.HostInitDiagnostics})},t.prototype.sendWacPostMessage=function(t,i){this.cn&&this.cn.contentWindow?this.nn.sendPostMessage(this.cn.contentWindow,t,i):this.Qe.ULS.u(595955718,a.P,s.Info,"Attempted to send postmessage: "+t)},t}(),gt=!1,St=!1;function _t(){gt=!1}function It(t,i,e,n,o,r,c){if(i.ULS.u(595714433,a.P,s.Info,"Starting disposing the application. unloadApp:"+t+"; disposed:"+gt+"; unloading:"+St),gt||St&&t)i.ULS.u(595714908,a.P,s.Info,"Application is already disposed or unloading");else{var u,h={logger:i,postMessenger:e,innerApplicationFrame:n,onDisposed:o,onFrameRemoved:r,unloadTimeoutInMs:c||1e3,forceAppUnload:!1,disposeStartTime:J(),appUnloadTimedOut:!1};if(t&&n)return St=!0,h.forceAppUnload=!0,(u=h).forceAppUnloadStartTime=J(),u.logger.ULS.u(595855490,a.P,s.Info,"Sending postmessage to unload app"),u.logger.ULS.flush(),u.postMessenger.registerMessagePayloadHandler(Q.bi,(function(t){return function(t,i){t.forceAppUnloadEndTime=J(),t.appUnloadedMessageValues=i,t.logger.ULS.u(595855491,a.P,s.Info,"AppUnloaded received from app"),bt(t)}(u,t)})),u.postMessenger.sendPostMessage(u.innerApplicationFrame.contentWindow,tt.re,{}),void window.setTimeout((function(){return function(t){!St&&gt||(t.appUnloadTimedOut=!0,t.logger.ULS.u(595855492,a.P,s.Info,"ApplicationUnload timed out, forcing dispose"),bt(t))}(u)}),u.unloadTimeoutInMs);bt(h)}}function bt(t){if(!gt)try{gt=!0,St=!1,function(t){if(!t.innerApplicationFrame)return;t.innerApplicationFrame.src="about:blank",window.setTimeout((function(){t.innerApplicationFrame&&t.innerApplicationFrame.parentElement&&t.innerApplicationFrame.parentElement.removeChild(t.innerApplicationFrame),t.onFrameRemoved&&t.onFrameRemoved()}),0)}(t),function(t){var i={disposeStartTime:t.disposeStartTime,disposeEndTime:J(),forceAppUnload:t.forceAppUnload,appUnloadTimedOut:t.appUnloadTimedOut};t.forceAppUnloadStartTime&&(i.appUnloadStartTime=t.forceAppUnloadStartTime);t.forceAppUnloadEndTime&&(i.appUnloadEndTime=t.forceAppUnloadEndTime);if(t.appUnloadedMessageValues){var e=t.appUnloadedMessageValues,n=Number(e.hostMessageReceived);t.forceAppUnloadStartTime&&!isNaN(n)&&(i.hostToAppPostMessageLatency=n-t.forceAppUnloadStartTime);var o=Number(e.appMessageSent);!isNaN(o)&&t.forceAppUnloadEndTime&&(i.appToHostPostMessageLatency=t.forceAppUnloadEndTime-o);var r=Number(e.appUnloadStart),c=Number(e.appUnloadEnd);if(isNaN(r)||isNaN(c)||(i.appUnloadLatency=c-r),e.serverTimings){var u=e.serverTimings;for(var h in u)i["st-"+h.toString()]=u[h]}}t.logger.ULS.u(595855436,a.P,s.Info,"App disposed "+JSON.stringify(i)),t.logger.ULS.flushOnClose()}(t),t.onDisposed&&t.onDisposed()}catch(i){t.logger.ULS.u(595714434,a.P,s.Error,"Error disposing: "+L(i))}}var Ct,At,yt=function(){function t(t,i,e,n,o,s,r){var a=this;this.un=!1,this.hn=!1,this.fn=!1,this.dn=null,this.ln=!0,this.pn=!1,this.mn=!1,this.tn=t,this.in=i,this.rn=t.diagnostics.AppInitDiagnostics,this.Qe=e,this.nn=n,this.on=s,this.sn=r,this.an=t.diagnostics.SessionTraces,this.an.wopiPendingInitializeTime=J(),this.vn=o,_t(),window.setTimeout((function(){return a.timeoutCompleteOrFail()}),5e3)}return t.prototype.Complete=function(t,i){if(this.fn)this.Qe.ULS.u(596444184,a.P,s.Warning,"Complete called after Complete/Fail already called");else{this.Qe.ULS.u(596444185,a.P,s.Info,"Complete called."),this.fn=!0,this.wn=t,this.an.wopiPendingCompleteTime=J();try{this.in.isSingleStepBoot?this.completeSingleStepFlow():this.completeTwoStepFlow(),this.un&&this.sendWacPostMessage(tt.oe,{}),this.updateBrowserHistoryForCreateNew(i)}catch(t){this.Qe.ULS.u(596444186,a.P,s.Error,"Unexpected script error: "+L(t))}finally{this.Qe.ULS.flush()}}},t.prototype.Fail=function(t){this.fn?this.Qe.ULS.u(596444187,a.P,s.Warning,"Fail called after Complete/Fail already called"):(this.Qe.ULS.u(596444188,a.P,s.Warning,"Fail called. Reason: "+(t?JSON.stringify(t):"N/A")),this.fn=!0,this.in.isSingleStepBoot?this.failSingleStepFlow():this.failTwoStepFlow(t),this.Qe.ULS.flush())},t.prototype.Dispose=function(t,i,e){var n=this;It(t||!1,this.Qe,this.nn,this.cn,(function(){delete n.cn,i&&i(),n.vn(),n.nn.dispose()}),void 0,e)},t.prototype.Boot=function(){this.in.isSingleStepBoot||this.bootTwoStepFlow(),this.Qe.ULS.flush()},t.prototype.bootTwoStepFlow=function(){var t=this;this.Qe.ULS.u(596444231,a.P,s.Info,"Initializing Office frame WITHOUT WOPI info - first step of two step flow."),window.setTimeout((function(){return t.timeoutWacReadyMessage()}),5e3),this.nn.registerMessagePayloadHandler(Q.Rt,(function(i){t.handleWacReadyMessage(i)})),this.nn.registerMessagePayloadHandler(Q.wi,(function(i){t.handleWacFrameSessionCompleteAckMessage(i)}));var i=new wt(this.tn,this.in,this.Qe,this.nn,this.on,this.sn);this.cn=i.Boot()},t.prototype.completeTwoStepFlow=function(){var t={ParallelizeStartSession:this.ln,WacFrameIsLoaded:this.un,WacAcceptsStartSessionComplete:this.pn};this.Qe.ULS.u(596444232,a.P,s.Info,"Completing the initialized application WITH the WOPI info - second step of two step flow. Current app state - "+JSON.stringify(t)),!this.ln||this.un&&!this.pn?this.un&&this.sendWopiInfoToWacFrame():this.makeStartSessionRequest()},t.prototype.completeSingleStepFlow=function(){this.Qe.ULS.u(596444233,a.P,s.Info,"Initializing Office frame WITH WOPI info - single step WOPI boot flow."),this.tn.wopiInfo=this.wn;var t=new wt(this.tn,this.in,this.Qe,this.nn,this.on,this.sn);this.cn=t.Boot()},t.prototype.failTwoStepFlow=function(t){this.un?(this.Qe.ULS.u(595968481,a.P,s.Warning,"Fail called and wacframe is able to accept postmessages"),this.sendFailurePostMessageToWacFrame(t)):(this.Qe.ULS.u(595968482,a.P,s.Warning,"Fail was called on the session prior to WacReady."),this.dn=t)},t.prototype.sendFailurePostMessageToWacFrame=function(t){this.Qe.ULS.u(596444189,a.P,s.Warning,"Fail called, sending the failure postmessage to IFrame"),this.sendWacPostMessage(tt.ee,t)},t.prototype.failSingleStepFlow=function(){this.Qe.ULS.u(596444190,a.P,s.Warning,"Fail called during single step boot, calling host failure callback..."),this.sn({errorType:et.InvalidWopiInfo,errorObject:new TypeError("wopiInfo")})},t.prototype.timeoutWacReadyMessage=function(){this.un||(this.Qe.ULS.u(596444191,a.P,s.Warning,"Timeout Wac Ready"),this.sn({errorType:et.TimeoutWacReady,errorObject:void 0}))},t.prototype.timeoutCompleteOrFail=function(){this.fn||(this.an.timeoutCompleteOrFail=J(),this.Qe.ULS.u(596444192,a.P,s.Warning,"Timeout Complete or Fail. SessionTraces:"+JSON.stringify(this.an)))},t.prototype.timeoutWacSessionCompletionMessageAck=function(t,i,e){this.mn||(this.Qe.ULS.u(596444193,a.P,s.Info,"SessionCompletion timed out with no ack."),this.sendSessionCompletionMessageWithRetryHelper(t,i,e+1))},t.prototype.handleWacReadyMessage=function(t){if(this.an.readyMessageReceiveTime=J(),this.sendWacPostMessage(tt.Ri,{}),this.un)this.Qe.ULS.u(596444194,a.P,s.Info,"Received multiple ready messages - frame is already loaded.");else{this.un=!0,this.pn=t&&t.CanAcceptStartSessionComplete;var i={AcceptStartSessionComplete:this.pn,ParallelizeStartSession:this.ln,StartSessionResponse:null!=this.gn,WopiInfo:null!=this.wn};this.Qe.ULS.u(596444195,a.P,s.Info,"HandleWacReadyMessage - "+JSON.stringify(i)),this.fn&&(this.dn?this.sendFailurePostMessageToWacFrame(this.dn):this.sendWacPostMessage(tt.oe,{})),this.ln&&this.pn?this.gn&&this.startSessionCompleted():this.wn&&this.sendWopiInfoToWacFrame(),rt(this.rn,t)}},t.prototype.handleWacFrameSessionCompleteAckMessage=function(t){this.mn=!0,this.an.sessionCompleteAckReceivedTime=J()},t.prototype.sendWacPostMessage=function(t,i){this.cn&&this.nn.sendPostMessage(this.cn.contentWindow,t,i)},t.prototype.sendSessionCompletionMessageWithRetry=function(t,i){this.sendSessionCompletionMessageWithRetryHelper(t,i,1)},t.prototype.sendSessionCompletionMessageWithRetryHelper=function(t,i,e){var n=this;if(e>3)this.Qe.ULS.u(596444224,a.P,s.Error,"Attempted to call complete, but received no ack from the frame. Time: "+J());else{this.Qe.ULS.u(596444225,a.P,s.Info,"Sending completion message to frame. Attempt number: "+e+", Time: "+J());var o=J();1===e&&(this.gn&&this.gn.Diagnostics&&(this.gn.Diagnostics.completeMessageCreateTime=o),this.an.completeMessageCreateTime=o),i.Diagnostics.completeMessageSendTime=o,this.an.completeMessageSendTime=o,this.sendWacPostMessage(t,i),window.setTimeout((function(){return n.timeoutWacSessionCompletionMessageAck(t,i,e)}),1e3)}},t.prototype.makeStartSessionRequest=function(){var t=this;this.Qe.ULS.u(596444226,a.P,s.Info,"Making parallelized startSession request.");var i=this.buildStartSessionUrl(this.wn),e={"Content-Type":"application/x-www-form-urlencoded"},n="access_token="+encodeURIComponent(this.wn.AccessToken)+"&access_token_ttl="+encodeURIComponent(lt(this.wn));this.an.startSessionStartTime=J(),function(t,i,e,n){var o=new XMLHttpRequest;for(var s in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){})}}},o.open("POST",t),e)o.setRequestHeader(s,e[s]);o.send(i)}(i,n,e,(function(i){return t.onStartSessionRequestCompleted(i)}))},t.prototype.onStartSessionRequestCompleted=function(t){if(this.an.startSessionCompleteTime=J(),this.an.startSessionResponseStatus=t.status,this.gn={StartSessionResponse:{RequestStatus:t.status,ResponseText:t.responseText},Diagnostics:{wopiPendingInitializeTime:this.an.wopiPendingInitializeTime,wopiPendingCompleteTime:this.an.wopiPendingCompleteTime,startSessionStartTime:this.an.startSessionStartTime,startSessionCompleteTime:this.an.startSessionCompleteTime,readyMessageReceiveTime:this.an.readyMessageReceiveTime}},this.Qe.ULS.u(596444227,a.P,s.Info,"StartSession request completed with status code: "+this.gn.StartSessionResponse.RequestStatus+", Time: "+J()),this.un&&this.pn)this.startSessionCompleted();else{var i={WacFrameIsLoaded:this.un,InitializeCompleted:this.hn};this.Qe.ULS.u(596444228,a.P,s.Info,"StartSessionCompleted not called - "+JSON.stringify(i))}},t.prototype.sendWopiInfoToWacFrame=function(){if(!this.hn){this.hn=!0,this.Qe.ULS.u(596444229,a.P,s.Info,"Sending wopi info to the frame.");var t={WopiDetails:{WopiSrc:this.wn.WopiSrc,AccessToken:this.wn.AccessToken,AccessTokenTtl:lt(this.wn)},Diagnostics:{wopiPendingInitializeTime:this.an.wopiPendingInitializeTime,wopiPendingCompleteTime:this.an.wopiPendingCompleteTime,readyMessageReceiveTime:this.an.readyMessageReceiveTime}};this.sendSessionCompletionMessageWithRetry(tt.Mi,t)}},t.prototype.startSessionCompleted=function(){200===this.gn.StartSessionResponse.RequestStatus?this.hn||(this.hn=!0,this.sendSessionCompletionMessageWithRetry(tt.ki,this.gn)):this.sendWopiInfoToWacFrame()},t.prototype.buildStartSessionUrl=function(t){var i=this.tn.applicationBasePath+"wordeditorstartsession.ashx",e=dt(this.tn,this.in,!1);return i=T(i+="?"+e.substring(e.indexOf("?")+1),"WOPISrc",encodeURIComponent(t.WopiSrc)),i=T(i,"build",encodeURIComponent(P())),i=T(i,"WacUserType",encodeURIComponent("WOPI")),this.tn.wopiPrecheckInfo.FileGetUrl&&(i=T(i,"fileGetUrlPresent","1")),i},t.prototype.updateBrowserHistoryForCreateNew=function(t){if(this.tn.isCreateNew){if(!t||!t.NewFilePath)return void this.Qe.ULS.u(596444230,a.P,s.Error,"Either NewFileInfo or NewFilePath are not provided for a new file.");history.replaceState({},"",t.NewFilePath),t.UpdatedPageTitle&&(document.title=t.UpdatedPageTitle)}},t}();!function(t){t.blurFocus="blurFocus",t.boot="boot",t.completeCreateNew="completeCreateNew",t.continueAccessibilityLoop="continueAccessibilityLoop",t.createNew="createNew",t.dispose="dispose",t.grabFocus="grabFocus",t.popState="popState",t.rename="rename",t.sendAccessToken="sendAccessToken",t.sendAuthToken="sendAuthToken",t.sendCustomAuthConfig="sendCustomAuthConfig",t.sendEmbeddedViewUrl="sendEmbeddedViewUrl",t.sendSessionInfo="sendSessionInfo",t.sendUserAccessAndPermissions="sendUserAccessAndPermissions",t.sendWopiInfo="sendWopiInfo",t.switchMode="switchMode"}(Ct||(Ct={}));var Tt=((At={})[Ct.blurFocus]=tt.Fi,At[Ct.continueAccessibilityLoop]=tt.Hi,At[Ct.grabFocus]=tt.Di,At[Ct.popState]=tt.ji,At[Ct.rename]=tt.zi,At[Ct.sendAccessToken]=tt.Gi,At[Ct.sendAuthToken]=tt.qi,At[Ct.sendCustomAuthConfig]=tt.$i,At[Ct.sendEmbeddedViewUrl]=tt.Zi,At[Ct.sendSessionInfo]=tt.Yi,At[Ct.sendUserAccessAndPermissions]=tt.Ki,At[Ct.sendWopiInfo]=tt.Qi,At[Ct.switchMode]=tt.se,At),Ut=function(){function t(t,i){var e=this;if(this.Sn=!1,this._n=function(t){return e.handleWacFramePostMessage(t)},this.In=!1,this.bn=!1,this.Cn=!1,this.An={},!t)throw new Error("Missing origin for PostMessageHandler");this.bn=S(t),this.Cn=_(t),this.Qe=i,this.setOrigin(t)}return t.prototype.registerMessagePayloadHandler=function(t,i){if(this.An[t])throw new Error("Duplicate registration!");this.An[t]=i},t.prototype.removeMessageHandler=function(t){delete this.An[t]},t.prototype.sendPostMessage=function(t,i,e){if(t){this.Qe.ULS.u(596464334,a.P,s.Info,"Sending message: "+i);var n={MessageId:i,SendTime:J(),Values:e};this.sendPostMessageInternal(t,JSON.stringify(n),this.yn)}else this.Qe.ULS.u(595948308,a.P,s.Info,"Missing target for SendPostMessage")},t.prototype.activate=function(t,i){void 0===i&&(i=!1),this.cn=t,this.In=i,this.Sn||(window.addEventListener("message",this._n,!1),this.Sn=!0)},t.prototype.postMessageForCommand=function(t,i,e){var n=Tt[i];n?(this.Qe.ULS.u(595702598,a.P,s.Info,"Sending message "+n+" for command "+i),this.sendPostMessage(t,n,e)):this.Qe.ULS.u(595702599,a.P,s.Warning,"No mapping for command "+i)},t.prototype.dispose=function(){for(var t=0,i=Object.keys(this.An);t<i.length;t++){var e=i[t];delete this.An[e]}this.Sn&&(window.removeEventListener("message",this._n,!1),this.Sn=!1)},t.prototype.sendAckBack=function(t,i,e){if(t){var n={MessageId:tt.Ei,CorrelationId:e,SendTime:J()};this.Qe.ULS.u(595732176,a.P,s.Info,"Sending Ack back"),t.postMessage(JSON.stringify(n),i)}else this.Qe.ULS.u(595736136,a.P,s.Info,"Missing target to send Ack back")},t.prototype.handleWacFramePostMessage=function(t){var i=!1,e=!0,n="",o=!1;if(this.cn&&this.cn.contentWindow&&(i=!0,e=t.source===this.cn.contentWindow),t.origin&&(o=(n=C(t.origin,2).toLowerCase())===this.Tn),!this.bn&&(!this.Cn||o&&e)||this.Qe.ULS.u(595730526,a.P,s.Info,"Window is available: "+i+", window is valid: "+e+", origin is valid: "+o+", expected origin: "+this.Tn+", actual origin: "+n),o&&(!this.In||e)){var r;try{r=JSON.parse(t.data)}catch(t){return void this.Qe.ULS.u(596464282,a.P,s.Info,"Failed to parse event data: "+L(t)+".")}var c=r.MessageId;if(c){this.Qe.ULS.u(595714715,a.P,s.Info,"Received messageId: "+c+", correlation: "+r.CorrelationId),c!==Q.Nt&&c!==Q.ei||this.setOrigin(t.origin),r.Values&&r.Values.ackExpected&&this.sendAckBack(t.source,t.origin,r.CorrelationId);var u=this.An[c];if(u){this.Qe.ULS.u(596464288,a.P,s.Info,"Processing message: "+c);try{u(r.Values||{})}catch(t){this.Qe.ULS.u(593773704,a.P,s.Error,"Handler error: "+L(t))}}else this.Qe.ULS.u(596464289,a.P,s.Info,"No handler found for message id: "+c)}else(this.bn||this.Cn)&&this.Qe.ULS.u(595730520,a.P,s.Info,"Could not find message id")}},t.prototype.sendPostMessageInternal=function(t,i,e){t.postMessage(i,e)},t.prototype.setOrigin=function(t){var i=t.toLowerCase();this.yn&&this.yn!==i&&this.Qe.ULS.u(596128131,a.P,s.Warning,"Updating origin:"+this.yn+"->"+i),this.yn=i,this.Tn=C(i,2),this.bn=S(i),this.Cn=_(i)},t}(),Ot=function(){function t(){var t=this;if(this.Un=[],this.An=[],this.On=function(){return t.handleVisibilityChange()},"hidden"===document.visibilityState){var i={visibility:document.visibilityState,time:J(),initialState:!0};this.Un.push(i)}document.addEventListener("visibilitychange",this.On)}return t.prototype.RegisterEventHandler=function(t){this.An.push(t)},t.prototype.RemoveEventHandler=function(t){if(t){var i=this.An.indexOf(t);this.An.splice(i,1)}},t.prototype.Stop=function(){document.removeEventListener("visibilitychange",this.On)},t.prototype.GetVisibilityChangeEvents=function(){return this.Un},t.prototype.Dispose=function(){this.Stop(),this.An=[],this.Un=[]},t.prototype.handleVisibilityChange=function(){var t={visibility:document.visibilityState,time:J(),initialState:!1};this.Un.push(t);for(var i=0,e=this.An;i<e.length;i++){var n=e[i];n&&n(t)}},t}();var Wt=function(){function t(){this.Wn=[]}return t.prototype.add=function(t){t&&this.Wn.push(t)},t.prototype.remove=function(t){if(t){var i=this.Wn.indexOf(t);i>-1&&this.Wn.splice(i,1)}},t.prototype.removeAll=function(){this.Wn=[]},t.prototype.dispatch=function(t,i){this.Wn.forEach((function(e){try{e(t)}catch(t){i&&i(t)}}))},t}(),Et=function(){function t(t,i){var e=this;this.En=0,this.Rn=function(){if(e.Pn){var t=new XMLHttpRequest;t.open("GET",e.Pn),t.responseType="json",t.timeout=5e3,t.send(),t.onload=function(){if(200===t.status&&t.response?(e.setSettingsOnIdle(t.response),e.En=0):(e.Qe.ULS.u(592836771,a.P,s.Error,"Fetch settings error. Status: "+t.status+", curErrors: "+e.En),e.En+=1),!(e.En>7)){var i=e.getValue(x.ft,3e5);e.En>3&&(i+=(e.En-3+1)*(i/2)),e.Fn=window.setTimeout(e.Rn,i)}}}},this.Nn=t,this.xn="Prod"+t+"Settings",this.Qe=i,this.kn=new Wt,this.getCurrentSettings()}return t.prototype.initializePeriodicFetch=function(t,i){this.xn=(S(t)?"FF":"Prod")+this.Nn+"Settings",this.getCurrentSettings(),this.Pn=t+"AppSettingsHandler.ashx?app="+this.Nn+"&usid="+i+"&build="+P(),this.Fn||(this.Fn=window.setTimeout(this.Rn,3e4))},t.prototype.getValue=function(t,i){if(this.Mn||this.getCurrentSettings(),!this.Mn||!this.Mn.hasOwnProperty(t))return i;var e=this.Mn[t],n=typeof i;if(typeof e===n)return e;if("string"==typeof e){if("number"===n)return parseInt(e,10);if("boolean"===n)return"true"===e}return i},t.prototype.addSettingsChangeListener=function(t){this.kn.add(t)},t.prototype.removeSettingsChangeListener=function(t){this.kn.remove(t)},t.prototype.dispose=function(){this.Fn&&window.clearTimeout(this.Fn),this.Hn&&self.cancelIdleCallback(this.Hn),this.Fn=void 0,this.Hn=void 0,this.Mn=void 0,this.kn.removeAll()},t.prototype.getCurrentSettings=function(){try{if(!window||!window.localStorage)return;var t=window.localStorage.getItem(this.xn);if(!t)return;var i=JSON.parse(t);this.updateCurrentSettings(i)}catch(t){this.Qe.ULS.u(592836768,a.P,s.Warning,"Failed to get settings from localStorage: "+L(t))}},t.prototype.updateCurrentSettings=function(t){var i=this;return!!this.isValidSettings(t)&&(this.Mn=t,this.kn.dispatch({Wt:this},(function(t){i.Qe.ULS.u(592836769,a.P,s.Error,"Settings listener error: "+L(t))})),!0)},t.prototype.isValidSettings=function(t){if(t&&"object"==typeof t){if(t.hasOwnProperty(x.dt)&&!isNaN(t.timestamp))return!0;this.Qe.ULS.u(592836770,a.P,s.Error,"Received invalid settings")}return!1},t.prototype.setSettingsOnIdle=function(t){var i=this;"requestIdleCallback"in window?(this.Hn&&self.cancelIdleCallback(this.Hn),this.Hn=window.requestIdleCallback((function(){return i.setSettings(t)}),{timeout:1e4})):window.setTimeout((function(){return i.setSettings(t)}),0)},t.prototype.setSettings=function(t){if(this.updateCurrentSettings(t)&&window&&window.localStorage){var i=JSON.stringify(t);try{window.localStorage.setItem(this.xn,i)}catch(t){this.Qe.ULS.u(592836800,a.P,s.Warning,"Failed to set localStorage: "+L(t))}}},t}();function Rt(t,i,e,n,o,s){void 0===s&&(s=!1),t.SessionInformation.IsCore&&(t.SessionInformation.HideViewerToolbar=!0),function(t,i){var e=t.SessionInformation;e.WdParams||(e.WdParams={});if(e.WdParams.wd)return;i.substring(1).split("&").filter((function(t){if(0===t.indexOf("wd")){var i=t.split("=");i[0].length>2&&(e.WdParams[i[0]]=i[1])}}));var n=t.RebootOverrideData;n&&n.previousSessionId&&(e.WdParams.wdprevioussession=n.previousSessionId)}(t,window.location.search);var r,a=o||new Et("OneNote",e);return{container:t.Container,sessionInformation:t.SessionInformation,applicationUrl:t.ApplicationUrl,wopiPrecheckInfo:t.WopiPrecheckInfo,applicationCustomSettings:t.ApplicationCustomSettings,diagnostics:{HostInitDiagnostics:t.Diagnostics,AppInitDiagnostics:{officeSessionId:i,officeBootstrapperVersion:P(),hostName:t.SessionInformation.HostName},SessionTraces:{}},fnOnInitializeSuccess:t.FnOnInitializeSuccess,fnOnInitializeFailure:t.FnOnInitializeFailure,sessionId:i,applicationBasePath:st(t.ApplicationUrl),wopiInfo:t.WopiInfo,forceSingleStepBoot:s,isCreateNew:t.WopiPrecheckInfo.IsNewFile||(r=t.ApplicationUrl,/[?&]new=1\b/i.test(r)),featureManager:n||pt(t.FnIsFeatureEnabled,e),Wt:a,newFileTemplateSource:t.NewFileTemplateSource,rebootOverrideData:t.RebootOverrideData}}var Pt,Ft=function(){function t(t,i){this.Dn=t,this.Bn=i}return t.prototype.GetVersion=function(){return P()},t.prototype.GetMinContentVersion=function(){throw new Error("Not implemented")},t.prototype.Prefetch=function(t){if(null!=t&&void 0!==t){var i=document.createElement("link");i.rel="prefetch";var e=t.BootstrapperUrl;".js"!==e.toString().slice(-3)&&(e+=".js"),i.href=e;var n=document.getElementsByTagName("head")[0];null!=n&&void 0!==n&&n.appendChild(i)}},t.prototype.InitializeWopiPending=function(t,i,e,n,o,r){var c,u,h,f,d,l=!1;try{var p=J();!function(t){if(void 0===t)throw new TypeError("initParams");var i=t.Container;if(void 0===i||void 0===i.appendChild)throw new TypeError("Container");var e=t.SessionInformation;if(void 0===e||void 0===e.HostName||void 0===e.HostSessionId||void 0===e.UserId)throw new TypeError("SessionInformation");var n=t.ApplicationUrl;if(void 0===n||"string"!=typeof n)throw new TypeError("ApplicationUrl");var o=t.WopiPrecheckInfo;if(void 0===o||void 0===o.FileName)throw new TypeError("WopiPrecheckInfo");if(void 0===t.FnOnInitializeSuccess)throw new TypeError("FnOnInitializeSuccess");if(void 0===t.FnOnInitializeFailure)throw new TypeError("FnOnInitializeFailure")}(t),function(t){if(t.RebootOverrideData);}(t),e?h=e:(h=(c=X())[0],f=c[1]),u=i||ot({remoteUlsEndpoint:st(t.ApplicationUrl)+"RemoteUls.ashx",sessionId:h}),d=Rt(t,h,u,o,r,this.Bn.forceSingleStepBoot),r||(d.Wt.addSettingsChangeListener(u.settingsChangeHandler),d.Wt.initializePeriodicFetch(d.applicationBasePath,h)),d.diagnostics.HostInitDiagnostics&&(d.diagnostics.HostInitDiagnostics.hostInitializeCallTime=p);var m,v=d.diagnostics.HostInitDiagnostics;if(v&&window.performance&&window.performance.timing){var w=window.performance.timing.navigationStart;v.hostPageNavigationStartTime=w}ut(u,d,f),l=!0,function(t,i){k=function(){return z(t,"OnBeforeUnload",i)},M=function(){return z(t,"OnPageHide",i)},H=function(){return z(t,"VisibilityChange_"+document.visibilityState,i)},window.addEventListener("beforeunload",k,{capture:!0,once:!0}),window.addEventListener("pagehide",M,{capture:!0}),window.addEventListener("visibilitychange",H,{capture:!0})}(u,!0);var g=t.BootstrapperUrl;g&&(m=this.periodicPrefetch(g,u));var S=function(){d.Wt.dispose(),window.removeEventListener("beforeunload",k,{capture:!0}),window.removeEventListener("pagehide",M,{capture:!0}),window.removeEventListener("visibilitychange",H,{capture:!0}),window.clearInterval(m)},_=b(t.ApplicationUrl),I=n||new Ut(_,u),C=new Ot,A=function(t,i){var e={isSingleStepBoot:t.forceSingleStepBoot,bootFlowType:t.forceSingleStepBoot?ft.forceSingleStepBoot:ft.bootWithoutWopiInfo,ignoreWacFramePostMessages:!1};if(t.forceSingleStepBoot,e.isSingleStepBoot){var n={singleStepBootIsRequired:!0,singleStepBootReason:e.bootFlowType,irmEnabled:t.wopiPrecheckInfo.IrmEnabled,readOnly:t.wopiPrecheckInfo.ReadOnly,ignoreWacFramePostMessages:e.ignoreWacFramePostMessages};i.ULS.u(596444182,a.P,n.irmEnabled?s.Warning:s.Info,JSON.stringify(n))}else i.ULS.u(596444183,a.P,s.Info,"Received input valid for two step flow");return e}(d,u),T=function(t,i,e,n,o,r,c,u){return function(h){ct(t,o),at(t.SessionTraces,n,s.Info);var f=xt(t);n.ULS.u(596448985,a.P,s.Info,JSON.stringify(f));var d=u(i,n,e,r,h);try{c(d,f)}catch(t){n.ULS.u(595719171,a.P,s.Error,"Exception thrown from host's success callback: "+L(t))}j("onenote",n),Nt(n)}}(d.diagnostics,d.sessionId,I,u,C,S,t.FnOnInitializeSuccess,this.Dn),U=function(t,i,e,n){return function(o){ct(t,e),at(t.SessionTraces,i,s.Warning);var r=xt(t);i.ULS.u(596448986,a.P,s.Error,JSON.stringify({error:o,appInitDiagnostics:r}));try{n(o,r)}catch(t){i.ULS.u(595719172,a.P,s.Error,"Exception thrown from host's failure callback: "+L(t))}j("onenote",i),Nt(i)}}(d.diagnostics,u,C,t.FnOnInitializeFailure);if("undefined"!=typeof PerformanceResourceTiming&&void 0===PerformanceResourceTiming.prototype.toJSON&&(PerformanceResourceTiming.prototype.toJSON=function(){return{name:this.name,connectStart:this.connectStart,connectEnd:this.connectEnd}}),t.FnOnAppModeSwitched&&I.registerMessagePayloadHandler(Q.ni,t.FnOnAppModeSwitched),t.WopiPrecheckInfo.ReadOnly&&t.FnOnAppModeSwitched&&t.FnOnAppModeSwitched({NewMode:"view"}),g&&this.Bn.preloader&&this.Bn.preloader.shouldPreload(d.applicationUrl))try{var O=g;0,d.featureManager.isFeatureEnabled(it.ve)&&(u.ULS.u(595645891,a.P,s.Info,"HTTP2 preload enabled"),O=function(t){var i=new RegExp("(c[1-5])h?(-)");return t.replace(i,"$1h$2")}(g));var W=d.sessionInformation.UiLocale;W||(W=decodeURIComponent(y(d.applicationUrl,"ui"))),this.Bn.preloader.preload(O,W,u,d.featureManager)}catch(t){u.ULS.u(595943884,a.P,s.Error,L(t))}var E=new yt(d,A,u,I,S,T,U);return E.Boot(),E}catch(i){return u&&(u.ULS.u(596459925,a.P,s.Error,et.AppInitError+": "+L(i)),l||ut(u,d||Rt(t,h,u,o,r,this.Bn.forceSingleStepBoot),f),u.ULS.flushOnClose()),void t.FnOnInitializeFailure({errorType:et.AppInitError,errorObject:i},void 0)}},t.prototype.periodicPrefetch=function(t,i){var e=this;return window.setInterval((function(){e.Prefetch({BootstrapperUrl:t}),i.ULS.u(595895774,a.P,s.Info,"Prefetching "+U(t))}),36e5)},t}();function Nt(t){t.ULS.u(590914655,a.P,s.Info,"Time spent logging: "+t.getTimeSpentLogging())}function xt(t){return o(o(o({},t.AppInitDiagnostics),t.HostInitDiagnostics),{SessionTraces:t.SessionTraces})}!function(t){t.BrowserEvent="BrowserEvent",t.PageChanged="PageChanged",t.ZoomChanged="ZoomChanged",t.ContentRefreshBegin="ContentRefreshBegin",t.ContentRefreshEnd="ContentRefreshEnd",t.AppClosed="UI_Close",t.UserEdit="Edit_Notification",t.FileRename="File_Rename",t.FileShare="UI_Sharing",t.ShowFileVersions="UI_FileVersions",t.UIWorkflow="UI_Workflow",t.IsDisabled="IsDisabled",t.AccessibilityLoopComplete="App_AccessibilityLoopComplete",t.Unloaded="Unloaded",t.Disposed="Disposed",t.SwitchMode="App_SwitchMode",t.DocumentReboot="DocReboot",t.WopiInfoFromUrl="WopiInfoFromUrl",t.ModeSwitched="ModeSwitched",t.CreateNewDocument="App_CreateNewDocument",t.GetAuthToken="GetAuthToken",t.GetCustomAuthConfig="GetCustomAuthConfig",t.SetOverlayContent="SetOverlayContent"}(Pt||(Pt={}));Q.zt,Q.Kt,Q.li,Q.yi;var kt=function(){function t(t,i,e,n,o){this.An={},this.Jn=!1,this.Ln=!1,this.jn=t,this.Qe=i,this.cn=o.innerApplicationFrame,this.nn=e,this.Vn=n,this.registerPostMessageHandlers(),_t()}return t.prototype.GetApplicationType=function(){throw new Error("Not implemented")},t.prototype.GetVersion=function(){return P()},t.prototype.GetSessionId=function(){return this.jn},t.prototype.RegisterEventHandler=function(t,i){if(this.Ln)throw new Error("RegisterEventHandler is not supposed to be called");this.Jn=!0,this.registerEventHandlerInternal(t,i)},t.prototype.RemoveEventHandler=function(t,i){if(this.Ln)throw new Error("RemoveEventHandler is not supposed to be called");switch(t){case Pt.Unloaded:case Pt.Disposed:case Pt.DocumentReboot:case Pt.WopiInfoFromUrl:case Pt.GetAuthToken:case Pt.GetCustomAuthConfig:case Pt.SetOverlayContent:if(this.An[t]!==i)throw new Error("The handler requested to be removed does not exist for the eventType");delete this.An[t];break;default:this.nn.removeMessageHandler(t)}},t.prototype.RegisterErrorHandler=function(t){},t.prototype.RemoveErrorHandler=function(t){},t.prototype.RegisterAllEventsHandler=function(t){throw new Error("RegisterAllEventsHandler is not supposed to be called")},t.prototype.PostCommand=function(t,i){this.nn.postMessageForCommand(this.cn.contentWindow,t,i)},t.prototype.Dispose=function(t,i){var e=this;It(t||!1,this.Qe,this.nn,this.cn,(function(){delete e.cn,e.Vn(),e.nn.dispose(),e.raiseEvent(Pt.Unloaded,{})}),(function(){try{e.raiseEvent(Pt.Disposed,{}),e.An={}}catch(t){e.Qe.ULS.u(589108815,a.P,s.Error,"onFrameRemoved error: "+L(t))}}),i)},t.prototype.registerEventHandlerInternal=function(t,i){switch(t){case Pt.Unloaded:case Pt.Disposed:case Pt.DocumentReboot:case Pt.WopiInfoFromUrl:case Pt.GetAuthToken:case Pt.GetCustomAuthConfig:case Pt.SetOverlayContent:if(this.An[t])throw new Error("Duplicate registration");this.An[t]=i;break;default:this.nn.registerMessagePayloadHandler(t,i)}},t.prototype.registerPostMessageHandlers=function(){this.nn.registerMessagePayloadHandler(Q.hi,this.handleDocumentRebootMessage.bind(this)),this.nn.registerMessagePayloadHandler(Q.ii,this.handleWopiInfoFromUrlRequest.bind(this)),this.nn.registerMessagePayloadHandler(Q.Qt,this.handleAuthTokenRequest.bind(this)),this.nn.registerMessagePayloadHandler(Q.ti,this.handleCustomAuthConfigRequest.bind(this))},t.prototype.raiseEvent=function(t,i){var e=this.An[t];if(e)try{e(i||{})}catch(t){this.Qe.ULS.u(593773706,a.P,s.Error,"Handler error: "+L(t))}},t.prototype.handleDocumentRebootMessage=function(t){t.previousSessionId=this.jn,this.raiseEvent(Pt.DocumentReboot,t)},t.prototype.handleWopiInfoFromUrlRequest=function(t){this.raiseEvent(Pt.WopiInfoFromUrl,t)},t.prototype.handleAuthTokenRequest=function(t){this.raiseEvent(Pt.GetAuthToken,t)},t.prototype.handleCustomAuthConfigRequest=function(t){this.raiseEvent(Pt.GetCustomAuthConfig,t)},t}();function Mt(t,i,e,n,o){return new kt(t,i,e,n,o)}var Ht=function(){function t(t,i,e){this.zn=t,this.Gn=i,this.Qe=e,this.applicationName="Word",this.sessionId=t.GetSessionId(),this.version=t.GetVersion(),this.cn=this.getInnerApplicationFrame()}return t.prototype.focus=function(){this.cn&&this.cn.contentWindow&&this.Gn.sendPostMessage(this.cn.contentWindow,tt.Di,{})},t.prototype.blur=function(){this.cn&&this.cn.contentWindow&&this.Gn.sendPostMessage(this.cn.contentWindow,tt.Fi,{})},t.prototype.renameFile=function(t){this.cn&&this.cn.contentWindow&&this.Gn.sendPostMessage(this.cn.contentWindow,tt.zi,{NewName:t})},t.prototype.registerEventHandler=function(t,i){this.Gn.registerMessagePayloadHandler(t,i)},t.prototype.removeEventHandler=function(t,i){this.Gn.removeMessageHandler(t)},t.prototype.registerErrorHandler=function(t){this.qn=t},t.prototype.removeErrorHandler=function(t){if(this.qn!==t)throw new Error("The handler requested to be removed does not exist");delete this.qn},t.prototype.dispose=function(){this.Gn.dispose(),this.Qe&&this.Qe.ULS.flushOnClose(),this.cn&&this.cn.parentElement&&this.cn.parentElement.removeChild(this.cn),delete this.cn,this.zn&&this.zn.Dispose()},t.prototype.closeOneNoteAfterSync=function(t){var i=this;this.Gn.registerMessagePayloadHandler(Q.Ci,(function(e){t&&t.onUnloadingApp&&t.onUnloadingApp(e),e.HasUnsavedData||(i.dispose(),t.onClose())})),this.Gn.registerMessagePayloadHandler(Q.Jt,(function(e){t&&t.onAppDataSavedStatus&&t.onAppDataSavedStatus(e),i.dispose(),t.onClose()})),this.cn&&this.cn.contentWindow&&this.Gn.sendPostMessage(this.cn.contentWindow,tt.Pi,{})},t.prototype.getInnerApplicationFrame=function(){return document.getElementById("WebApplicationFrame")},t}();var Dt,Bt=function(){function t(t){this.version=P(),this.Bn=t,this.$n=new Ft(Mt,t)}return t.prototype.prefetch=function(){},t.prototype.initialize=function(t){var i=this;this.Xn=t.onInitializeSuccess,this.Zn=t.onInitializeFailure;var e=X(),n=e[0],o=e[1],r=function(t,i,e,n){var o=b(t);o=o.replace("onenote",i);var s=[];if(n)for(var r in n)n[r]&&s.push(r.concat("=",n[r]));return o.concat(e,"?",s.join("&"),s.length>0?"&":"","<ui=UI_LLCC&><rs=DC_LLCC&><dchat=DISABLE_CHAT&><hid=HOST_SESSION_ID&><showpagestats=PERFSTATS&><IsLicensedUser=BUSINESS_USER&><actnavid=ACTIVITY_NAVIGATION_ID&>")}(t.discoveryUrl,this.Bn.applicationUrlSubdomain||"onenote",this.Bn.applicationUrlPath||"/o/onenoteframe.aspx"),c=ot({remoteUlsEndpoint:st(r)+"RemoteUls.ashx",sessionId:n,uploadCadenceInMs:6e4});c.ULS.u(595937311,a.P,s.Info,JSON.stringify(o));var u=new Ut(b(r),c);if(this.Bn.additionalApplicationParameters)for(var h in t.customSettings.additionalApplicationParameters=t.customSettings.additionalApplicationParameters||{},this.Bn.additionalApplicationParameters)t.customSettings.additionalApplicationParameters[h]||(t.customSettings.additionalApplicationParameters[h]=this.Bn.additionalApplicationParameters[h]);var f=function(t,i,e,n){return{Container:t.container,BootstrapperUrl:t.discoveryUrl,SessionInformation:{HostName:t.sessionInfo.hostName,HostSessionId:t.sessionInfo.hostSessionId,UserId:t.sessionInfo.userId,OwnerId:t.sessionInfo.ownerId,UiLocale:t.sessionInfo.uiLocale,DataLocale:t.sessionInfo.dataLocale,DisableChat:t.sessionInfo.disableChat,CookieCompliant:t.sessionInfo.cookieCompliant,SessionContext:t.sessionInfo.sessionContext,WdParams:t.sessionInfo.WdParams,HighContrastMode:t.sessionInfo.highContrastMode,SupportsDocReboot:t.sessionInfo.supportsDocReboot,SupportsAccessibilityLoop:t.sessionInfo.supportsAccessibilityLoop,UiHostIntegrationType:t.sessionInfo.uiHostIntegrationType,MetaUiHostVersion:t.sessionInfo.metaUiHostVersion},ApplicationUrl:n,WopiPrecheckInfo:{FileName:t.sessionInfo.fileName,FileGetUrl:t.sessionInfo.fileUrl,FileSize:t.sessionInfo.fileSize,BundleInfo:t.sessionInfo.bundleInfo?{MajorVersion:t.sessionInfo.bundleInfo.majorVersion,Url:t.sessionInfo.bundleInfo.url,BundleStaleness:t.sessionInfo.bundleInfo.bundleStaleness}:void 0,IsNewFile:!1,IsNewFileFromHostTemplate:!1,ReadOnly:t.sessionInfo.permissionsHint?t.sessionInfo.permissionsHint.readOnly:void 0},ApplicationCustomSettings:{additionalApplicationParameters:t.customSettings.additionalApplicationParameters,HostUIControls:t.customSettings.hostUIControls},Diagnostics:{entryPoint:t.diagnostics.entryPoint,userClickTime:t.diagnostics.userClickTime,hostPageNavigationStartTime:t.diagnostics.hostPageNavigationStartTime,hostPageFetchStartTime:t.diagnostics.hostPageFetchStartTime,hostPageFirstFlushTime:t.diagnostics.hostPageFirstFlushTime,hostInitializeCallTime:t.diagnostics.hostInitializeCallTime,hostCompleteCallTime:t.diagnostics.hostCompleteCallTime,officeBootstrapperStartTime:t.diagnostics.officeBootstrapperStartTime,officeBootstrapperEndTime:t.diagnostics.officeBootstrapperEndTime,officeInitializationTime:t.diagnostics.officeInitializationTime},WopiInfo:{WopiSrc:t.wopiInfo.wopiSrc,AccessToken:t.wopiInfo.accessToken,AccessTokenExpiry:t.wopiInfo.accessTokenExpiry},FnOnInitializeSuccess:i,FnOnInitializeFailure:e}}(t,this.getV1ApplicationInitializationSuccesssHandler(u,c),this.getV1ApplicationInitializationFailureHandler(),r);if(this.Yn=this.$n.InitializeWopiPending(f,c,n,u),void 0===this.Yn){var d={errorType:et.AppInitError,errorObject:{}};this.Zn(d)}if(this.Yn&&f.WopiInfo&&this.Yn.Complete(f.WopiInfo),t.diagnostics&&t.diagnostics.isHostRenderingEnabled){var l=document.getElementById("WebApplicationFrame");l&&(l.style.opacity="0.0")}return{dispose:function(){i.Yn&&i.Yn.Fail("Cancelled")}}},t.prototype.getV1ApplicationInitializationSuccesssHandler=function(t,i){var e=this;return function(n,o){e.Xn&&e.Xn(new Ht(n,t,i),o)}},t.prototype.getV1ApplicationInitializationFailureHandler=function(){var t=this;return function(i,e){t.Zn&&t.Zn(i,e)}},t}();!function(t){t[t.NotSupported=0]="NotSupported",t[t.SameDocOnly=1]="SameDocOnly",t[t.AnyDoc=2]="AnyDoc",t[t.OtherMode=4]="OtherMode"}(Dt||(Dt={})),e.d(i,"Application",(function(){return jt})),e.d(i,"EmbedApplication",(function(){return Gt})),e.d(i,"StaffOrClassEmbedApplication",(function(){return qt})),e.d(i,"DocRebootSupportMode",(function(){return Dt}));var Jt,Lt,jt=new Ft(Mt,{forceSingleStepBoot:!0,preloader:(Jt=function(t){return t.toLowerCase().indexOf("onenoteframe.aspx")>0},Lt=function(t,i){var e=b(t)+"/o/s/"+F()+"_",n=["App_Scripts/common.min.js","App_Scripts/wacBoot.min.js","App_Scripts/onenoteSync.min.js","App_Scripts/jSanity.js"],o=function(t){var i=t?t.toLowerCase().split("-")[0]:"en";return E[i]}(i);o&&(n=n.concat(["resources/"+o+"/EditSurface.css","resources/"+o+"/OneNote.css"]));var s=n.map((function(t){return e+t}));return s.push(e.replace("onenote","officeapps")+"App_Scripts/MicrosoftAjax.js"),s.map((function(t){return[t,void 0]}))},{shouldPreload:function(t){return Jt(t)},preload:function(t,i,e,n){Lt(t,i,n).forEach((function(t){!function(t,i,e,n,o){var r=document.createElement("link");if(r.setAttribute("crossorigin","anonymous"),r.rel=W,r.href=t,i){var c=e||U(t);i.ULS.u(592315601,a.P,s.Info,"Preloading resource: "+c),r.addEventListener("error",(function(){i.ULS.u(592479445,a.P,s.Error,"Resource failed to load: "+c)}))}r.setAttribute("as","script"),n&&r.setAttribute("integrity",n),document.head.appendChild(r),o&&r.addEventListener("load",o,{once:!0})}(t[0],e,void 0,t[1])}))}})}),Vt={forceSingleStepBoot:!0,applicationUrlSubdomain:"onenote",applicationUrlPath:"/o/onenoteframe.aspx"},zt={embed:"1",embedded:"1",removeshareui:"1",hideheader:"1",hidepagesearch:"1",disablefile:"0",disableview:"0",disableprint:"0",disablechat:"1",uiembed:"1"},Gt=new Bt(o(o({},Vt),{additionalApplicationParameters:zt})),qt=new Bt(o(o({},Vt),{additionalApplicationParameters:o(o({},zt),{hidesections:"1"})}))}});

