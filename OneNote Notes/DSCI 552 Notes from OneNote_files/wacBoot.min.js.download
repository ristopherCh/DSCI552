var wacBoot=function(e){function t(t){for(var i,s,l=t[0],r=t[1],d=t[2],u=0,p=[];u<l.length;u++)s=l[u],a[s]&&p.push(a[s][0]),a[s]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);for(c&&c(t);p.length;)p.shift()();return o.push.apply(o,d||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],i=!0,l=1;l<n.length;l++){var r=n[l];0!==a[r]&&(i=!1)}i&&(o.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},a={21:0},o=[];function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(){return Promise.resolve()},s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var l=window.webpackJsonp_name_=window.webpackJsonp_name_||[],r=l.push.bind(l);l.push=t,l=l.slice();for(var d=0;d<l.length;d++)t(l[d]);var c=r;return o.push([1332,0]),n()}({1332:function(e,t,n){"use strict";n.r(t);var i,a={g_initialRequestMade:!1,g_initialRequestCompleted:!1,g_getCellsFromFrameRequest:void 0,g_initialRequestResponseObject:void 0,g_acquireLockStartTime:void 0,g_acquireLockEndTime:void 0,g_acquireLockRequestStatus:void 0,g_getDocumentStartTime:void 0,g_getDocumentEndTime:void 0,g_getDocumentRequestStatus:void 0,g_getCellsStartTime:void 0,g_getCellsEndTime:void 0,g_getInitializeLocalCobaltStartTime:void 0,g_getInitializeLocalCobaltEndTime:void 0,g_initialResponseTime:void 0,g_initialResponseReadyTime:void 0,g_fastViewOpenTime:void 0,g_initialRequestInvokedTime:void 0,g_onInitialResponseReady:void 0,g_isUserCreatingPersonalNotebookFirstTime:!1,g_networkType:void 0,g_bootSSRData:void 0,g_bootSSRHtmlStringLength:void 0},o={fastView:void 0,initialParaId:0,fastBootError:void 0},s=function(){function e(){}return e.getElement=function(e){if(this.DOMElements.hasOwnProperty(e))return this.DOMElements[e];var t=document.getElementById(e);return t?this.DOMElements[e]=t:null},e.removeElement=function(e){e&&this.DOMElements.hasOwnProperty(e.id)&&delete this.DOMElements[e.id],e&&e.parentNode&&e.parentNode.removeChild(e)},e.removeElementById=function(e){this.removeElement(this.getElement(e))},e.DOMElements={},e}(),l=function(){function e(){}return e.initialize=function(e,t,n,i,a,o,s,l,r,d,c,u){this.isViewMode=e,this.isEmbedMode=t,this.isInTouchMode="ontouchstart"in window,this.isSimplifiedReactRibbonInTreatment=n,this.isOldRibbonCollapsedCookieOn="false"!==b.getCookie(i).toLowerCase(),this.isSimplifiedRibbonCookieOn="false"!==b.getCookie(a).toLowerCase(),this.isNewHeaderShown=!this.isViewMode,this.isSimplifiedReactRibbonShown=this.isSimplifiedReactRibbonInTreatment&&this.isSimplifiedRibbonCookieOn&&!this.isViewMode,this.isOldRibbonExpandedAndShown=!this.isSimplifiedReactRibbonShown&&!this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isOldRibbonCollapsedAndShown=!this.isSimplifiedReactRibbonShown&&this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isViewModeAndRibbonPanelSmall=this.isViewMode&&this.isOldRibbonCollapsedCookieOn&&!this.isSimplifiedReactRibbonInTreatment,this.isViewModeAndRibbonPanelLarge=this.isViewMode&&(!this.isOldRibbonCollapsedCookieOn||this.isSimplifiedReactRibbonInTreatment),this.isSnackbarNavPaneEnabled=o,this.isTwoPaneNavEnabled=s,this.isCssPositionRewriteEnabled=l,this.hideSkeletalHeader=r,this.hideSkeletalRibbon=d,this.hideSkeletalNavPane=c,this.embedViewer=u},e}();!function(e){e[e.HideAnimationTime=256]="HideAnimationTime",e[e.MinWidthToShowPageColumnPane=900]="MinWidthToShowPageColumnPane",e[e.MinWidthToShowNavpane=499]="MinWidthToShowNavpane",e[e.MinWidthToResizeTwoPaneNav=425]="MinWidthToResizeTwoPaneNav",e[e.MinWidthForTwoPaneNav=300]="MinWidthForTwoPaneNav"}(i||(i={}));var r=0,d=!1,c=!1,u=function(){function e(){}return e.clearAriaLoadingAttributes=function(){var e=document.getElementById("applicationOuterContainer");e&&(e.removeAttribute("aria-busy"),e.removeAttribute("aria-hidden"))},e.getFastViewSkeletalClass=function(){return l.isCssPositionRewriteEnabled?this._getPositionRewriteFastViewSkeletalClass():this._getAbsoluteFastViewSkeletalClass()},e.updateRibbonPanel=function(){l.isCssPositionRewriteEnabled&&l.isSimplifiedRibbonCookieOn?this._updatePositionRewriteRibbonPanel():this._updateAbsoluteRibbonPanel()},e.updateWacDocumentPanel=function(){l.isCssPositionRewriteEnabled&&l.isSimplifiedRibbonCookieOn?this._updatePositionRewriteWacDocumentPanel():this._updateAbsoluteWacDocumentPanel()},e.customizeSkeletalExperience=function(){r=document.body.clientWidth,l.isSimplifiedReactRibbonShown?s.removeElementById("SkeletalAdditionOldRibbon"):s.removeElementById("SkeletalNewRibbon"),l.isEmbedMode||l.embedViewer?(s.removeElementById("SkeletalHeader"),s.removeElementById("SkeletalNewHeader")):l.isNewHeaderShown?s.removeElementById("SkeletalHeader"):s.removeElementById("SkeletalNewHeader"),l.hideSkeletalRibbon&&s.removeElementById("SkeletalRibbon"),l.hideSkeletalNavPane&&s.removeElementById("SkeletalNavpane"),this._customizeSkeletalExperienceLayout()},e.bringFastViewToForegroundOfSkeletalCanvas=function(){var e=s.getElement("WACFastView");e&&(e.style.position="initial")},e.removeAllSubunitsFromSkeletalCanvas=function(){var e=s.getElement("SkeletalCanvas");if(e)for(var t=e.children.length-1;t>=0;t-=1){var n=e.children.item(t);n&&"WACFastView"!==n.id&&e.removeChild(n)}},e.fadeOutAndRemoveElement=function(e,t){var n=s.getElement(e);n&&(n.style.background="transparent",n.style.opacity="0",n.className+=" skeletalCover",window.setTimeout((function(){s.removeElement(n),t&&t()}),i.HideAnimationTime))},e.setMainContentEditable=function(){if(!d){d=!0,this.fadeOutAndRemoveElement("SkeletalNavpane"),this.fadeOutAndRemoveElement("SkeletalMainContent");var e=document.getElementById("load_back");e&&(e.style.height="auto")}},e._getPositionRewriteFastViewSkeletalClass=function(){return e._getAbsoluteFastViewSkeletalClass()},e._getAbsoluteFastViewSkeletalClass=function(){var e="";return p()?e="SkeletalFastViewRtl":(e="SkeletalFastView",l.isTwoPaneNavEnabled&&!l.isEmbedMode?e="SkeletalFastView":l.isEmbedMode||r<=i.MinWidthToShowNavpane?e="SkeletalFastViewNoNavpane":r<=i.MinWidthToShowPageColumnPane&&(e="SkeletalFastViewPageColumnNavpane")),l.isViewModeAndRibbonPanelLarge&&(e+=" SkeletalFastViewViewMode"),l.isEmbedMode&&(e+=" SkeletalFastViewEmbedMode"),e},e._collapseSkeletalRibbon=function(){l.isCssPositionRewriteEnabled?e._collapsePositionRewriteSkeletalRibbon():e._collapseAbsoluteSkeletalRibbon()},e._collapsePositionRewriteSkeletalRibbon=function(){e._collapseAbsoluteSkeletalRibbon()},e._collapseAbsoluteSkeletalRibbon=function(){var e=s.getElement("SkeletalMainContent");e&&!l.isCssPositionRewriteEnabled&&(e.className+=l.isEmbedMode?" collapsedRibbonEmbedMode":" collapsedRibbon"),s.removeElementById("SkeletalRibbonExtension")},e._updatePositionRewriteRibbonPanel=function(){if(!c)if(l.isViewMode)c=!0;else{document.getElementById("WACRibbonPanel")&&(c=!0);var e=document.getElementsByClassName("WACReadingBarPanel").item(0);e&&(e.style.display="none")}},e._updateAbsoluteRibbonPanel=function(){if(!c){var e=document.getElementsByClassName("WACReadingBarPanel").item(0);if(l.isViewMode&&e)c=!0,l.isViewModeAndRibbonPanelLarge?e.className+=" RibbonPanelMaximizedViewMode":l.isViewModeAndRibbonPanelSmall&&(e.className+=" RibbonPanelMinimized");else{var t=document.getElementById("WACRibbonPanel");null!=t&&(c=!0,l.isSimplifiedReactRibbonShown?(t.className+=" RibbonPanelSLRMode",t.className+=" RibbonPanelNewSLRMode"):l.isOldRibbonExpandedAndShown&&!l.isInTouchMode?t.className+=" RibbonPanelMaximized":l.isOldRibbonExpandedAndShown&&l.isInTouchMode?t.className+=" RibbonPanelMaximizedTouchMode":l.isOldRibbonCollapsedAndShown&&(t.className+=" RibbonPanelMinimized")),e&&(e.style.display="none")}}},e._updatePositionRewriteWacDocumentPanel=function(){var e=document.getElementById("WACDocumentPanelContent");null!=e&&(e.style.border="unset")},e._updateAbsoluteWacDocumentPanel=function(){var e=document.getElementById("WACDocumentPanel"),t=document.getElementById("WACDocumentPanelContent");null!=e&&(e.className+=" skeletalEnabled",l.isViewModeAndRibbonPanelLarge?e.style.top="40px":l.isViewModeAndRibbonPanelSmall?e.style.top="30px":l.isSimplifiedReactRibbonShown?e.style.top="77px":l.isOldRibbonCollapsedCookieOn||l.isInTouchMode||(e.style.top="124px"),p()?e.style.right="0px":l.isTwoPaneNavEnabled&&!l.isEmbedMode?r<i.MinWidthForTwoPaneNav?e.style.left=i.MinWidthToShowNavpane.toFixed()+"px":r<i.MinWidthToResizeTwoPaneNav?e.style.left=r.toFixed()+"px":e.style.left="426px":l.isEmbedMode||r<=i.MinWidthToShowNavpane?e.style.left="0px":r<=i.MinWidthToShowPageColumnPane?e.style.left="198px":l.isSnackbarNavPaneEnabled?e.style.left="426px":e.style.left="393px"),null!=t&&(t.style.border="unset")},e._customizeSkeletalExperienceLayout=function(){var t=s.getElement("SkeletalMainContent"),n=s.getElement("SkeletalExperience"),a=s.getElement("SkeletalRibbon");if(l.hideSkeletalHeader&&n&&(n.className+=" noHeader"),l.hideSkeletalRibbon&&n&&(n.className+=" noRibbon"),l.hideSkeletalNavPane&&n&&(n.className+=" noNavPane"),l.isViewMode?(n&&l.isCssPositionRewriteEnabled&&n.classList.remove("skeletalSLRGridRows"),a&&(a.innerHTML=""),l.isViewModeAndRibbonPanelSmall?(t&&!l.isCssPositionRewriteEnabled&&(t.style.top=l.isEmbedMode?"30px":"78px"),n&&l.isCssPositionRewriteEnabled&&(n.className+=" skeletalLegacyRibbonGridRows"),a&&!l.isCssPositionRewriteEnabled&&(a.className="skeletalRibbon skeletalRibbonCollapsedViewMode")):l.isViewModeAndRibbonPanelLarge?(a&&!l.isCssPositionRewriteEnabled&&(a.className="skeletalRibbon skeletalRibbonExpandedViewMode"),l.isCssPositionRewriteEnabled&&n?n.className+=" skeletalReadingRibbonGridRows":!l.isCssPositionRewriteEnabled&&t&&(t.style.top=l.isEmbedMode?"40px":"88px")):n&&l.isCssPositionRewriteEnabled&&(n.className+=" skeletalReadingRibbonGridRows")):n&&!l.isSimplifiedReactRibbonShown&&l.isCssPositionRewriteEnabled&&(l.isOldRibbonExpandedAndShown&&!l.isInTouchMode?n.className+=" skeletalLegacyRibbonMaximizedGridRows":l.isOldRibbonExpandedAndShown&&l.isInTouchMode?n.className+=" skeletalLegacyRibbonMaximizedTouchModeGridRows":l.isOldRibbonCollapsedAndShown&&(n.className+=" skeletalLegacyRibbonGridRows")),l.isSimplifiedReactRibbonShown?a&&(a.className=l.isCssPositionRewriteEnabled?"skeletalPositionRewriteRibbon":"skeletalSLRNewVisual"):a&&l.isCssPositionRewriteEnabled&&(a.className="skeletalPositionRewriteRibbon",l.isViewMode&&(a.className+=" viewMode")),l.isEmbedMode){a&&(l.isCssPositionRewriteEnabled||(a.style.top="0px"));var o=s.getElement("SkeletalAdditionOldRibbon");o&&!l.isCssPositionRewriteEnabled&&(o.style.top="0px")}if(p()&&e._loadSkeletalInRTL(),l.isOldRibbonCollapsedAndShown?e._collapseSkeletalRibbon():l.isOldRibbonExpandedAndShown&&l.isEmbedMode&&t&&!l.isCssPositionRewriteEnabled&&(t.style.top="125px"),l.isTwoPaneNavEnabled&&!l.isEmbedMode){var d=s.getElement("SkeletalNavpane"),c=s.getElement("SkeletalNavpaneSectionColumn"),u=s.getElement("SkeletalNavpanePageColumn"),b=s.getElement("SkeletalCanvas"),m=s.getElement("SkeletalExperience");if(null!=d&&null!=c&&null!=u&&null!=b&&null!=m)if(r<=i.MinWidthForTwoPaneNav)l.isCssPositionRewriteEnabled?m.className+=" skeletalOreoTwopaneShrunkGridColumns":(d.style.width="300px",b.style.left="299px"),c.style.width="124px",u.style.width="124px";else if(r<=i.MinWidthToResizeTwoPaneNav){l.isCssPositionRewriteEnabled?m.style.gridTemplateColumns=r.toFixed()+"px 100%":(d.style.width=r.toFixed()+"px",b.style.left=r-1+"px");var h=.5*r-24;c.style.width=h.toFixed()+"px",u.style.width=h.toFixed()+"px"}}else if(l.isEmbedMode||r<=i.MinWidthToShowNavpane){s.removeElementById("SkeletalNavpane");b=s.getElement("SkeletalCanvas");var f=s.getElement("SkeletalExperience");l.isCssPositionRewriteEnabled&&f&&!l.hideSkeletalNavPane?l.isTwoPaneNavEnabled?f.className+=" skeletalNoTwopaneGridColumns":f.className+=" skeletalNoNavpaneGridColumns":!l.isCssPositionRewriteEnabled&&b&&(b.style.left="0px")}else if(r<=i.MinWidthToShowPageColumnPane){d=s.getElement("SkeletalNavpane");var g=s.getElement("SkeletalNotebookName"),R=(b=s.getElement("SkeletalCanvas"),s.getElement("SkeletalExperience"));s.removeElementById("SkeletalNavpaneSectionColumn"),s.removeElementById("skeletalNavpaneTab"),l.isCssPositionRewriteEnabled&&R?R.className+=" skeletalLegacyNavpanePageOnlyGridColumns":l.isCssPositionRewriteEnabled&&null!=d&&null!=b&&(d.style.width="201px",b.style.left="200px"),g&&(g.style.right="42px")}if(l.isSimplifiedReactRibbonShown&&null!=t)l.isCssPositionRewriteEnabled||(t.style.paddingTop=l.isEmbedMode?"74px":"126px",t.style.top="0px");else if(l.isOldRibbonCollapsedAndShown){var S=document.getElementsByClassName("skeletalRibbonBoxContainer").item(0),v=s.getElement("SkeletalRibbonBar");null!=t&&null!=v&&null!=S&&(s.removeElement(S),v.style.height="29px",v.style.borderBottom="1px solid #d2d2d2",l.isCssPositionRewriteEnabled||(t.style.top="0px"))}else if(l.isOldRibbonExpandedAndShown&&l.isInTouchMode){var E=s.getElement("SkeletalRibbonExtension");null==t||null==E||l.isCssPositionRewriteEnabled||(E.style.height="108px",t.style.top="187px")}},e._loadSkeletalInRTL=function(){var e=["SkeletalHeader","SkeletalNewHeader","SkeletalRibbonAppTitle","SkeletalSLRAppTitle","SkeletalRibbon","SkeletalAdditionOldRibbon","SkeletalMainContent","SkeletalCanvas"];for(var t in e){var n=s.getElement(e[t]);n&&(n.className+=" skeletalRTL")}var i=s.getElement("SkeletalCanvas");i&&(i.className+=" skeletalCanvasRtl")},e}();function p(){var e=s.getElement("SkeletalExperience");return null!=e&&"rtl"===e.getAttribute("direction")}var b=function(){function e(){}return e.ensureCookieCompliance=function(e,t){if(e){var n=[];t&&(n=JSON.parse(t)),WacCookieCompliance.requestConsentWithSettings(new CookieComplianceSettings(n))}},e.getCookie=function(e){if(!e)return"";if(e.indexOf("=")>=0)throw new RangeError(" = is not found in the cookie");var t=""+document.cookie,n=new RegExp("(?:^|; )"+e+"=([^;]*)"),i=t.match(n);return!i||i.length<2?"":i[1]},e.isDocumentEmpty=function(e){function t(e,t){return-1===(" "+e.className+" ").indexOf(" "+t+" ")}var n=e.querySelectorAll(".Paragraph");return!(!n||1!==n.length)&&(2===n[0].childElementCount&&!t(n[0].children[0],"TextRun")&&!t(n[0].children[1],"EOP")&&""===n[0].children[0].innerText)},e}();function m(){function e(){return navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("Macintosh")>=0&&t()&&!(navigator.userAgent.indexOf("iPhone")>=0)}function t(){return navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}return navigator.userAgent.indexOf("Android")>=0||e()||t()}function h(e,t,n,i){var a;if(a=e.cssPositionRewriteIsEnabled&&!i?"WACFastViewPositionRewrite":"WACFastView",e.wordIsSkeletalDeepLinkOn&&e.isDeepLinkScenario&&(a+=" Deeplink"),e.showRibbon||(a+=" HideRibbon"),e.showNavPane||(a+=" HideNavPane"),e.positionAbsolute){if(a+=" WACFastViewAbsolute",e.showRibbon?e.showRibbonHeader||(a+=" HeaderHidden"):a+=" HeaderAndRibbonHidden",e.showNavPane?e.showNavSections||(a+=" SectionsHidden"):a+=" NavHidden",e.simplifiedReactRibbonUxIsEnabled)a+=" OneLineRibbon",a+=" OneLineRibbonWithTabHeaderRefresh";else{var o=t(e.ribbonPreferenceCookieName);(!e.ribbonExpandedByDefault&&"false"===o||e.ribbonExpandedByDefault&&"true"!==o)&&(a+=" RibbonPinned",n&&(a+=" Touch"))}e.skeletalBootUXIsEnabled&&(a+=" "+u.getFastViewSkeletalClass()),e.snackbarNavPaneIsEnabled&&(a+=" Snackbar"),e.twoPaneNavIsEnabled&&(a+=" TwoPaneNav")}return a}function f(){var e=document.getElementById("load_img");e&&(e.style.opacity="0",e.style.height="1px");var t=document.getElementById("load_back");t&&(t.style.opacity="0",t.style.height="1px")}function g(e,t){if(!(t.wordIsSkeletalDeepLinkOn&&t.isDeepLinkScenario||0===o.initialParaId)){var n=document.querySelector("p[paraid='"+o.initialParaId+"']");if(!n||!n.getBoundingClientRect)return;var i=n.getBoundingClientRect().bottom,a=e.getBoundingClientRect().bottom;e.firstElementChild&&(e.firstElementChild.scrollTop=i-a+70)}}function R(){var e=document.getElementById("application");e&&(e.style.top="0")}var S=function(){function e(){}return e.launchExperience=function(t){l.initialize("false"===t.IsEditMode,"true"===t.IsEmbedMode,"true"===t.SimplifiedReactRibbonUxIsEnabled,t.RibbonPreferenceCookieNameHint,t.IsSimplifiedRibbonOnCookieName,"true"===t.SnackbarNavPaneIsEnabled,"true"===t.OneNoteTwoPaneNavPaneIsEnabled,"true"===t.OneNoteCssPositionRewriteIsEnabled,"true"===t.HideHeaderEmbedded,"true"===t.HideRibbonEmbedded,"true"===t.ONHideNavEmbedded,"true"===t.MobileEmbedViewer),u.customizeSkeletalExperience(),this.showSkeletalUx(),window.setTimeout((function(){e.dismissSkeletalBootUx(!0)}),this.FORCE_DISMISS_AFTER)},e.showSkeletalUx=function(){var e=s.getElement("SkeletalExperience");e&&(e.style.opacity="1",e.className+=" skeletalShow")},e.setRibbonReady=function(){this._isExperienceEnded||(this._isRibbonReady=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this._isContentReady&&u.fadeOutAndRemoveElement("SkeletalRibbon",(function(){self.dispatchEvent(new CustomEvent("RibbonVisible"))})))},e.setPageReady=function(){this._isExperienceEnded||(u.updateRibbonPanel(),u.updateWacDocumentPanel(),this._isContentReady=!0,this.tryDismissSkeletalBootUxIfAllComponentsReady()||this.dismissSkeletalCanvas())},e.setNavpaneReady=function(){this._isExperienceEnded||(u.updateRibbonPanel(),this._isNavpaneReady=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this._isContentReady&&u.fadeOutAndRemoveElement("SkeletalNavpane",(function(){u.setMainContentEditable()})))},e.setFastViewReady=function(){this._isExperienceEnded||this.dismissSkeletalCanvas()},e.showFastViewOnSkeletalCanvas=function(){u.bringFastViewToForegroundOfSkeletalCanvas(),u.removeAllSubunitsFromSkeletalCanvas()},e.tryDismissSkeletalBootUxIfAllComponentsReady=function(){return!!(this._isContentReady&&this._isNavpaneReady&&this._isRibbonReady)&&this.dismissSkeletalBootUx()},e.dismissSkeletalBootUx=function(t){if(void 0===t&&(t=!1),this._isExperienceEnded)return!1;var n=document.getElementById("load_back"),i=document.getElementById("WACDocumentPanel"),a=document.getElementById("WACRibbonPanel");return n&&i&&a?(e.removeSkeletalExperience(),e.adjustElementsAfterSkeletalDismissal(n,i,a),this._isExperienceEnded=!0,!0):(t&&e.removeSkeletalExperience(),!1)},e.removeSkeletalExperience=function(){var e=s.getElement("SkeletalExperience");e&&s.removeElement(e)},e.adjustWacRibbonAfterDismissSkeletal=function(e){l.isCssPositionRewriteEnabled?this.adjustPositionRewriteWacRibbonAfterDismissSkeletal(e):this.adjustAbsoluteWacRibbonAfterDismissSkeletal(e)},e.adjustPositionRewriteWacRibbonAfterDismissSkeletal=function(e){e.style.height="auto"},e.adjustAbsoluteWacRibbonAfterDismissSkeletal=function(e){l.isSimplifiedReactRibbonShown?e.style.height="77px":e.style.height="auto"},e.adjustWacCanvasAfterDismissSkeletal=function(e){l.isCssPositionRewriteEnabled&&l.isSimplifiedReactRibbonShown||this.adjustAbsoluteWacCanvasAfterDismissSkeletal(e)},e.adjustAbsoluteWacCanvasAfterDismissSkeletal=function(e){e.className="SkeletalWacDocumentPanel skeletalEnabled "+e.className},e.dismissSkeletalCanvas=function(){var e=this,t=document.getElementById("WACFastView");if(!this._isExperienceEnded||t&&t.parentElement&&"SkeletalCanvas"===t.parentElement.id){this._isContentReady=!0;var n=document.getElementById("load_back");null!=n&&(this.preDismissSkeletalCanvas(n),u.fadeOutAndRemoveElement("SkeletalCanvas",(function(){e._isNavpaneReady&&u.setMainContentEditable()})))}},e.preDismissSkeletalCanvas=function(e){l.isCssPositionRewriteEnabled?this.preDismissPositionRewriteSkeletalCanvas(e):this.preDismissAbsoluteSkeletalCanvas(e)},e.preDismissPositionRewriteSkeletalCanvas=function(e){this.preDismissAbsoluteSkeletalCanvas(e)},e.preDismissAbsoluteSkeletalCanvas=function(e){var t=document.getElementById("WACRibbonPlaceholder"),n=s.getElement("SkeletalRibbonExtension");if(null!=t&&null!=n&&(t.style.height="124px"),e.style.background="transparent",p()){var i=document.getElementById("application");i&&(i.style.minWidth="0px")}if(!l.isEmbedMode){var a=document.getElementById("AppHeaderPanel");a&&(a.style.height="48px")}},e.adjustElementsAfterSkeletalDismissal=function(e,t,n){e&&(e.style.display="none",e.style.height="1px",e.style.opacity="0",e.setAttribute("aria-hidden","true"),u.clearAriaLoadingAttributes()),t&&this.adjustWacCanvasAfterDismissSkeletal(t),n&&this.adjustWacRibbonAfterDismissSkeletal(n)},e._isRibbonReady=!1,e._isContentReady=!1,e._isNavpaneReady=!1,e._isExperienceEnded=!1,e.FORCE_DISMISS_AFTER=2e4,e}(),v=n(60),E=function(){function e(){}return e.getFloatingObjectsContainerWidth=function(){return 270},e.shouldShiftFastView=function(t,n,i){return e.shouldShiftBasedOnScreenSize(i)&&e.shouldShiftBasedOnNumSections(n)&&t},e.shouldShiftRealCanvas=function(t,n,i,a,o){if(!e.shouldShiftBasedOnScreenSize(t))return!1;var s=n(i);return!!e.shouldShiftBasedOnNumSections(s)&&a(o)},e.shouldShiftBasedOnScreenSize=function(e){return"Small"!==e},e.shouldShiftBasedOnNumSections=function(e){return 1===e},e}();function w(e,t){window._bB&&window._bB.sendBeacon(e,t)}var C=n(165),y=function(e,t){this.eventName=e,this.timeStamp=(new Date).getTime()-t},k=function(){function e(e,t,n,i,a,o,s,l,r){var d=this;void 0===a&&(a="Default"),void 0===o&&(o=b.getCookie),void 0===s&&(s=!1),void 0===l&&(l=!1),void 0===r&&(r=0),this.getTopbarContainerFunc=e,this.getRibbonContainerFunc=t,this.getDocumentContainerFunc=n,this.appearance=i,this.entry=a,this.getCookieFunc=o,this.fastViewOnSkeletal=s,this.hasUnresolvedComments=l,this.numSections=r,this._touchSupport=m(),this._handleKeyboardEvent=function(e){"Shift"!==e.key&&"Control"!==e.key&&"Alt"!==e.key&&d._logEventData(e.type)},this._handleEditableKeyboardEvent=function(e){(13===e.keyCode||e.ctrlKey&&(66===e.keyCode||73===e.keyCode||85===e.keyCode))&&(e.preventDefault(),d._logEventData(e.key))},this._handlePasteEvent=function(e){if(void 0!==d.isEditable&&void 0!==d.htmlElement&&void 0!==d._editableSpan&&d.isEditable&&d.appearance.pasteLoadingUI&&!d.isPasteLoading&&d.htmlElement.parentElement){d.isPasteLoading=!0;var t=function(e){var t=document.createElement("div");t.id="WACLoadingPasteUI";var n=document.createElement("div");n.className="WACFastLoadingBoxUI";var i,a=document.createElement("img");return a.src=e,a.className="WACProgressIcon",n.appendChild(a),t.appendChild(n),t.appendChild(((i=document.createElement("div")).className="WACFastLoadingOverlay WACDialogOverlay",i)),t.setAttribute("aria-busy","true"),t.setAttribute("role","progressbar"),t}(d.appearance.loadingUIGif);d.htmlElement.parentElement.appendChild(t),d.pasteData=function(e){var t={};if(null!=e&&null!=e.types){var n=e.types[0];t.type=n,t.data=e.getData(n)}else{var i=window.clipboardData,a=i.getData("text");null!==a?(t.type="text/plain",t.data=a):i.files.length>0&&(t.type="image/png",t.data=i.files[0])}return t}(e.clipboardData),d._editableSpan.removeAttribute("contentEditable"),e.preventDefault()}else d._blockEvent(e)},this._blockEvent=function(e){d._logEventData(e.type),e.preventDefault()},this._logEventData=function(e){d.eventLogs&&d.openTime&&d.eventLogs.push(new y(e,d.openTime))},this._handleEditableMousedownEvent=function(e){if(d._logEventData(e.type),d._editableSpan&&e.target!==d._editableSpan){if(d._editableSpan.focus(),window.getSelection){var t=window.getSelection();t&&t.collapseToEnd()}e.preventDefault()}},this._makeInitialParaEditable=function(e){var t=e.querySelector(".PageContentContainer");t&&(t.className+=" WACFastViewEditor",t.addEventListener("mousedown",(function(e){d._handleEditableMousedownEvent(e)}))),d._editableSpan=e.querySelector(".NormalTextRun"),d._editableSpan&&(d._editableSpan.contentEditable="true",d._editableSpan.style.outline="0px",d._editableSpan.spellcheck=!1,d._editableSpan.setAttribute("aria-hidden","true"),d._editableSpan.focus(),d._editableSpan.addEventListener("paste",(function(e){d._handlePasteEvent(e)})),d._editableSpan.addEventListener("keydown",(function(e){d._handleEditableKeyboardEvent(e)})))},this._sendBeaconForBoot=function(e){w(e,"BootPhaseCompleted")},this._shiftCanvas=function(e){if(null!=e){var t=e.querySelector(".OutlineContainer"),n=e.querySelector(".PageContentContainer");if(null!=t&&null!=n){var i=document.createElement("div"),a=E.getFloatingObjectsContainerWidth()+"px";d.appearance.isRtl?i.style.paddingLeft=a:i.style.paddingRight=a,n.appendChild(i),i.appendChild(t)}}},this._showRibbonPlaceholderIfRequired=function(){d.appearance.positionAbsolute&&d.appearance.showRibbon&&!d._ribbonPlaceholderShown&&!d.appearance.skeletalBootUXIsEnabled&&(d.showRibbonPlaceholder(),d._ribbonPlaceholderShown=!0)},this.eventLogs=[],this.openTime=0,this.hasShifted=!1}return e.prototype.removeKeypressEventListener=function(){this._keyboardEventHandler&&document.removeEventListener("keydown",this._keyboardEventHandler)},e.prototype.showRibbonPlaceholder=function(){var e=this;function t(e,t){var n=document.createElement("div");return n.className="ribbonBar",n.setAttribute("unselectable","on"),n.appendChild(e),n.appendChild(t),n}if(!document.getElementById("ExternalHeaderFullTopBars")){var n=this.getTopbarContainerFunc(),i=this.appearance.showHeaderPlaceholder?document.getElementById("HeaderPlaceholder"):void 0;if(n&&this.appearance.showRibbonHeader)if(i)this.topbarPlaceholderElement=i;else{var a=document.createElement("div");a.className="cui-topBar2",this.appearance.modernUXEnabled&&(a.className+=" ModernUXFastViewHeader"),a.setAttribute("unselectable","on");var o=document.createElement("div");o.id="WACTopbarPlaceholder";var s=function(){var t=document.createElement("div");t.className="cui-topBar1",e.appearance.reactSharedHeaderIsEnabled?t.className+=" cui-topBar1-transitionalReactHeaderUI":t.className+=" cui-topBar1-transistionalHeaderUI",e.appearance.modernUXEnabled&&(t.className+=" ModernUXFastViewHeader"),t.setAttribute("unselectable","on");var n="",i="";e.appearance.headerBackgroundColorOverride&&(n="background-color:"+e.appearance.headerBackgroundColorOverride+";"),e.appearance.headerTextColorOverride&&(i="color:"+e.appearance.headerTextColorOverride+";"),e.appearance.reactSharedHeaderIsEnabled&&(n||i)&&t.setAttribute("style",""+n+i);var a=document.createElement("span");a.className="cui-QATRowLeft BreadcrumbContainer";var o=document.createElement("span");o.className="AppAndBrandContainer",e.appearance.reactSharedHeaderIsEnabled&&n&&o.setAttribute("style",n);var s=document.createElement("div");s.className="WACFastBootLoader";var l=document.createElement("span");l.className="BreadcrumbItem";var r=e.appearance.reactSharedHeaderIsEnabled&&e.appearance.headerAppLauncherIsHidden;r?l.setAttribute("style","width:8px;height:48px;display:inline-block;"):l.setAttribute("style","width:48px;height:48px;display:inline-block;"),document.createElement("span").className="OfficeOnlineBrandSwitcherSeparator";var d=document.createElement("span");return d.className="headBrand",e.appearance.reactSharedHeaderIsEnabled?d.setAttribute("style","line-height:48px;margin-left:2px;"):d.setAttribute("style","line-height:48px;"),d.appendChild(document.createTextNode(e.appearance.appBrandedName)),o.appendChild(l),o.appendChild(d),r||o.appendChild(s),a.appendChild(o),t.appendChild(a),e.appearance.appColorUpdateIsEnabled&&(t.className+=" cui-color-update",o.className+=" cui-color-update"),t}();o.appendChild(s),o.appendChild(a),n.appendChild(o),this.topbarPlaceholderElement=o}var l=this.getRibbonContainerFunc();if(l&&0===l.children.length){var r=document.createElement("div");if(r.id="WACRibbonPlaceholder",r.className=r.id,this.appearance.showRibbon&&!this.appearance.skeletalBootUXIsEnabled)if(this.appearance.simplifiedReactRibbonUxIsEnabled)(d=function(n,i){var a=document.createElement("div");a.className=n?"oneLineRibbonUpperWithAnimation":"oneLineRibbonUpper",a.className+=" oneLineRibbonUpperWithTabHeaderRefresh";var o=document.createElement("div");return o.className=n?"oneLineRibbonLowerWithAnimation":"oneLineRibbonLower",e.appearance.modernUXEnabled&&(a.className+=" ModernUXFastViewRibbon",o.className+=" ModernUXFastViewRibbon"),i&&(o.style.height="90px"),t(a,o)}(this.appearance.simplifiedReactRibbonAnimationIsEnabled,this.appearance.reactMultiLineRibbonIsVisible)).addEventListener("click",(function(){e._logEventData("ribbonClick")})),r.appendChild(d);else if(this.appearance.showRibbonImage&&this.appearance.ribbonExpandedByDefault&&"true"!==this.getCookieFunc(this.appearance.ribbonPreferenceCookieName)){var d;(d=function(e,n){var i=document.createElement("div");i.className="ribbonUpper";var a=document.createElement("div");a.className="ribbonLower";var o=document.createElement("div");o.className="ribbonLeft";var s=function(e,t){var n=t;if(e){n=t.replace("bgapp_word_topleft","bgapp_word_topleft_touch")}return n}(e,n);return o.style.backgroundImage="url('"+s+"')",e&&(a.className+=" ribbonTouch",o.className+=" ribbonTouch"),i.appendChild(o),t(i,a)}(this._touchSupport,this.appearance.ribbonImageBase)).addEventListener("click",(function(){e._logEventData("ribbonClick")})),r.appendChild(d)}else r.style.height="30px";else r.className="cui-exth";l.appendChild(r),this.ribbonPlaceholderElement=r}}},e.prototype.open=function(e,t){var n=this;void 0===t&&(t=!1),this.appearance.showRibbonHeader||R(),this._showRibbonPlaceholderIfRequired();var i=this.getDocumentContainerFunc();if(!i||!e)return!1;var o="canvasWrap"===i.id,s=document.createElement("div"),l=h(this.appearance,this.getCookieFunc,this._touchSupport,o);if(this.appearance.isRegionComposerShown&&(l+=" WACFastViewRegionComposer"),this.appearance.reactMultiLineRibbonIsVisible&&(l+=" WACFastViewMLRVisible"),s.className=l,s.id="WACFastView",s.innerHTML=e,this.htmlElement=s,this.appearance.editable&&(this.isEditable=b.isDocumentEmpty(s)),t)s.style.visibility="hidden";else{this._keyboardEventHandler=this._handleKeyboardEvent,document.addEventListener("keydown",(function(e){n._keyboardEventHandler&&n._keyboardEventHandler(e)}));var r=function(e){n._logEventData(e.type)};if(s.firstChild)if(s.firstChild.addEventListener("scroll",r),s.firstChild.addEventListener("click",r),s.firstChild.addEventListener("dblclick",r),s.firstChild.addEventListener("contextmenu",(function(e){n._blockEvent(e)})),o)s.firstChild.classList.add("WACFastViewNavOreoGrid");if(E.shouldShiftFastView(this.hasUnresolvedComments,this.numSections,v.d())?(this._logEventData("Shifting Fast View"),this._shiftCanvas(s),this.hasShifted=!0):this._logEventData("Not shifting Fast View"),this._logEventData("HasUnresolvedComments: "+this.hasUnresolvedComments+", NumSections == 1: "+(1===this.numSections)+", ScreenSize == Small: "+("Small"===v.d())),i.appendChild(s),this.appearance.hostRenderingIsEnabled){var d=window.parent,c={MessageId:"App_SwitchToWacFrame",SendTime:(new Date).getTime(),CorrelationId:"",Values:{entryPoint:"FastView"}};""!==this.appearance.postMessageOrigin&&d.postMessage(c,this.appearance.postMessageOrigin)}navigator.userAgent.indexOf("Macintosh")>=0&&document.body.classList.add("Mac"),this.appearance.wordIsSkeletalDeepLinkOn&&this.appearance.isDeepLinkScenario&&document.body.classList.add("Deeplink"),this.fastViewOnSkeletal?S.showFastViewOnSkeletalCanvas():a.g_isUserCreatingPersonalNotebookFirstTime||(this.appearance.skeletalBootUXIsEnabled?S.setFastViewReady():f()),g(s,this.appearance),this._sendBeaconForBoot("RecordContentDisplayed"),this.isEditable&&(s.className+=" WACFastViewEditable",this._makeInitialParaEditable(s),this._sendBeaconForBoot("RecordAppInteractive"))}return this.openTime=(new Date).getTime(),Object(C.a)("ViewableEnd"),Object(C.d)("Viewable","StartWacBoot","ViewableEnd"),!0},e.prototype.isOpen=function(){return!(!this.htmlElement||!this.htmlElement.parentNode)},e.cssClass="WACFastView",e.cssPositionRewriteClass="WACFastViewPositionRewrite",e.cssClassAbsolute="WACFastViewAbsolute",e}(),P=function(e,t,n,i){void 0===n&&(n=!1),void 0===i&&(i=1),this.pageHtml=e,this.editable=t,this.hasUnresolvedComments=n,this.numSections=i};function N(e){if(e&&e.Responses[0]&&e.Responses[0][1]&&e.Responses[0][1].Cells)for(var t=e.Responses[0][1].Cells,n=0;n<t.length;n+=1){var i=t[n];if(i&&i.PageHtml)return new P(i.PageHtml,!!i.IsPageHtmlEditable,!!i.HasUnresolvedComments,i.NumSections)}}var I=function(){function e(){}return e.initialize=function(){this.metrics={initialVisibility:document.visibilityState,initializeTime:new Date,events:[]},document.addEventListener("visibilitychange",e.handleVisibilityChange)},e.stop=function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)},e.handleVisibilityChange=function(){var t={visibility:document.visibilityState,time:new Date};e.metrics.events.push(t)},e}();I.initialize();var O={g_appSettings:void 0,g_bootOptions:void 0,g_fastViewLauncher:void 0,g_bootSSRData:void 0,g_bootSettings:void 0,g_initialResponseReceived:!1,g_onInitialResponseReceived:void 0};function _(e,t,n){return{accessToken:n?n.AccessToken:e.AccessToken,accessTokenTtl:n?n.AccessTokenTtl:"",applicationModeExtended:e.SessionStartInfoJson?JSON.parse(e.SessionStartInfoJson).ApplicationModeExtended:"UNKNOWN",buildVersion:e.BuildVersion,canary:e.Canary,feMachineId:e.FEMachineId,logHostRequests:"true"===e.LogHostRequests?1:0,onenoteSyncEndpoint:e.ONOnlineSyncEndpoint,pageTarget:e.PageTarget,renderingMode:e.AddServerSideRenderingHeader,requestHeadMode:t,rootQuerySignature:e.RootQuerySignature,sessionOrigin:e.SessionOrigin?e.SessionOrigin:"UNKNOWN",url:e.WebServiceBase,userSessionId:e.SessionId,userType:e.UserType,wacCluster:e.WacCluster,wacUserAgent:e.WacUserAgent}}function A(e){var t={},n=JSON.parse(e);return t.Application=n.Application,t.ApplicationVersion=n.ApplicationVersion,t.Browser=n.Browser,t.BrowserMajorVersion=n.BrowserMajorVersion,t.BrowserVersion=n.BrowserVersion,t.Host=n.Host,t.IsSynthetic=n.IsSynthetic,t.Os=n.Os,t.Ring=n.Ring,t.RoutedVia=n.RoutedVia,t.SessionOrigin=n.SessionOrigin,t.UiHost=n.UiHost,t.UserSessionApplicationMode=n.UserSessionApplicationMode,t.WACDatacenter=n.WACDatacenter,JSON.stringify(t)}var T=n(166),x=function(){function e(t,n,i,a,o,s){Object(T.c)(o),Object(T.d)(Object(T.a)("StaticContentUrl",""));var l=function(e){return"true"===o[e]};this.fastBootEnabled=l("FastBoot"),e.slice0Name=o.Slice0Name,this.appearance={positionAbsolute:!(l("OneNoteCssPositionRewriteIsEnabled")&&B(o)),showRibbon:!l("HideRibbonEmbedded"),ribbonExpandedByDefault:t,ribbonPreferenceCookieName:o.RibbonPreferenceCookieNameHint,showRibbonImage:n,ribbonImageBase:o.RibbonImageBase,shouldStretchPageToBottom:i,appBrandedName:o.BrandedWebAppName,showRibbonHeader:!l("HideHeaderEmbedded"),showNavPane:a&&!l("ONHideNavEmbedded"),showNavSections:!l("ONHideSectionsEmbedded"),editable:!1,pasteLoadingUI:l("PasteInBootLoadingUIIsEnabled"),loadingUIGif:o.ProgressGifResource,simplifiedReactRibbonUxIsEnabled:B(o),simplifiedReactRibbonAnimationIsEnabled:M(o),skeletalBootUXIsEnabled:l("OneNoteSkeletalBootUXIsEnabled"),snackbarNavPaneIsEnabled:l("SnackbarNavPaneIsEnabled"),twoPaneNavIsEnabled:l("OneNoteTwoPaneNavPaneIsEnabled"),reactSharedHeaderIsEnabled:l("ReactSharedHeaderIsEnabled"),headerAppLauncherIsHidden:l("AppLauncherIsHidden"),headerBackgroundColorOverride:decodeURIComponent(b.getCookie("ThemedHeaderBackgroundColor")),headerTextColorOverride:decodeURIComponent(b.getCookie("ThemedHeaderTextColor")),cssPositionRewriteIsEnabled:l("OneNoteCssPositionRewriteIsEnabled")&&B(o),wordIsSkeletalDeepLinkOn:l("WordIsSkeletalDeepLinkOn"),isDeepLinkScenario:l("IsDeepLinkScenario"),reactMultiLineRibbonIsVisible:e.isReactMultilineRibbonVisible(o),renderFastViewOnSkeletalUXIsEnabled:l("OneNoteRenderFastViewOnSkeletalIsEnabled"),isRegionComposerShown:!!s,appColorUpdateIsEnabled:l("AppColorUpdateIsEnabled"),isRtl:l("Rtl"),showHeaderPlaceholder:l("ShowHeaderPlaceholder"),modernUXEnabled:l("ModernUxExperimentOneIsEnabled")&&V(o),hostRenderingIsEnabled:l("PageSSRHostRenderingIsEnabled"),postMessageOrigin:o.PostMessageOrigin}}return e.prototype.launchFastView=function(e,t,n,i,a,s){if(void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===s&&(s=0),w("Launching FastView from entry point "+t,"BootLogs"),this.appearance.editable=n,this.fastBootEnabled&&!o.fastView&&!document.getElementById("PageContentContainer")){var l,r=document.getElementById("canvasWrap");if(null!=r&&this.appearance.cssPositionRewriteIsEnabled)l=r;else{var d=this.appearance.renderFastViewOnSkeletalUXIsEnabled&&i?"SkeletalCanvas":"WACInnerFrame";l=document.getElementById(d)}o.fastView=new k((function(){return document.getElementById("AppHeaderPanel")}),(function(){return document.getElementById("WACRibbonPanel")}),(function(){return l}),this.appearance,t,b.getCookie,i,a,s);try{return o.fastView.open(e)}catch(e){return o.fastBootError="FastView open failed: "+e.message+"\r\n"+e.stack,!1}}return!1},e.getSlice0=function(){if(null!=e.slice0Name&&e.slice0Name.length>0){var t=document.createElement("script");t.type="text/javascript",t.src=e.slice0Name,document.getElementsByTagName("head")[0].appendChild(t)}},e.isReactMultilineRibbonVisible=function(e){return"true"===e.ReactMultilineRibbonIsEnabled&&(function(e){return"true"===b.getCookie(e.ReactRibbonMLRPreferenceCookieName).toLowerCase()}(e)||"false"===b.getCookie(e.IsSimplifiedRibbonOnCookieName).toLowerCase())},e}();function B(e){return"true"===e.SimplifiedReactRibbonUxIsEnabled&&function(e){if("false"===e.OptOutSupportForSimplifiedRibbonIsEnabled)return!0;return"false"!==b.getCookie(e.IsSimplifiedRibbonOnCookieName).toLowerCase()}(e)}function M(e){return"true"===e.OneLineRibbonAnimationIsEnabled&&B(e)}function V(e){return"false"!==b.getCookie(e.ModernUxExperimentPreferenceCookieName).toLowerCase()}var F=n(0),D=function(){function e(e,t){var n=this;this.onGetCellsRequestCompleted=function(e){if(w("Get cells response received:"+e.status,"BootLogs"),!a.g_initialRequestCompleted){if(U(e.responseText,!1),!o.fastView){var t=N(a.g_initialRequestResponseObject);t&&t.pageHtml&&n._fastViewFactory&&n._fastViewFactory.launchFastView(t.pageHtml,"WacBootGetCells",t.editable,!1,t.hasUnresolvedComments,t.numSections)}a.g_fastViewOpenTime=new Date}},this.onInitialResponseReady=function(){a.g_onInitialResponseReady&&a.g_onInitialResponseReady()},this._onRenderPageRequestCompleted=function(e){var t=e.responseText;if(!o.fastView){var i=function(e){var t=q(e);if(t&&t.Responses[0]&&t.Responses[0][1]&&t.Responses[0][1].Html)return t.Responses[0][1].Html;return}(t);i&&n._fastViewFactory&&n._fastViewFactory.launchFastView(i,"WacBootRenderPage")}},this._fastViewFactory=e,this._wacBootOptions=t}return e.prototype.makeGetCellsRequest=function(e,t){w("Making GetCells Request","BootLogs"),o.initialParaId=this._wacBootOptions.initParagraphId||0;var n=JSON.stringify(window.location.href),i=L(1,',"SearchQuery":null,"IsNewFile":'+(this._wacBootOptions.isNewFile&&this._wacBootOptions.optimizedForNewFile).toString()+',"InitialParaId":'+o.initialParaId+',"RequestUrl":'+n+',"SkipPageHtmlInResponse":'+this._wacBootOptions.skipPageHtmlInGetCellsResponse.toString(),this._wacBootOptions.requestOptions,{});return H(this._wacBootOptions.requestOptions.url+"OneNote.ashx"+(t?"?perfTag=GetCells_1&GetCellsBootstrapper=1":""),i,this._wacBootOptions,e,W)},e.prototype.makeRenderPageRequest=function(e){if(!this._wacBootOptions.isNewFile||!this._wacBootOptions.optimizedForNewFile){var t=L(46,"",this._wacBootOptions.requestOptions,e);H(this._wacBootOptions.requestOptions.url+"OneNote.ashx?IsRenderPage=1",t,this._wacBootOptions,this._onRenderPageRequestCompleted,(function(){}))}},e.prototype.makeStartSessionRequest=function(e,t){H(this._wacBootOptions.requestOptions.url+e,"",this._wacBootOptions,t,(function(){}))},e.getCellsFromFrameRequest=function(e){a.g_initialRequestCompleted||(U(e,!0),a.g_fastViewOpenTime=new Date)},e}();function L(e,t,n,i){var a=JSON.stringify(n.rootQuerySignature);a&&(a=a.substring(1,a.length-1));var o=JSON.stringify(n.pageTarget);o&&(o=o.substring(1,o.length-1));var s='{"Mode":'+n.requestHeadMode+',"srs":[[',l=',{"FileId":"'+a+'","PageTarget":"'+o+'","OperationId":1';for(var r in i)l+=',"'+r+'":'+i[r];return s+e+l+t+"}]]}"}function H(e,t,n,i,a){var o=new XMLHttpRequest,s={};for(var l in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{i&&i(o)}finally{null!=o&&(o.onreadystatechange=function(){},o=void 0)}}},o.open("Post",e,!0),function(e,t){var n=t.requestOptions;e["X-xhr"]="1",n.userSessionId&&(e["X-UserSessionId"]=n.userSessionId);n.buildVersion&&(e["X-OfficeVersion"]=n.buildVersion);e["Content-Type"]="application/json; charset=utf-8",n.canary&&(e["X-Key"]=n.canary);n.accessToken&&(e["X-AccessToken"]=n.accessToken);n.accessTokenTtl&&(e["X-AccessTokenTtl"]=n.accessTokenTtl);n.userType&&(e["X-UserType"]=n.userType);1===n.logHostRequests&&(e["X-LogHostRequests"]="1");n.wacCluster&&(e["X-WacCluster"]=n.wacCluster);n.wacUserAgent&&(e["X-WacUserAgent"]=n.wacUserAgent);n.renderingMode&&(e["X-ServerSideRendering"]=n.renderingMode);n.feMachineId&&(e["X-FEMachineId"]=n.feMachineId);t.sessionStartJson&&(e["X-SessionStartDimensions"]=t.sessionStartJson);e["X-Requested-With"]="XMLHttpRequest"}(s,n),s)o.setRequestHeader(l,s[l]);var r=t;return t||(r=""),a(),o.send(r),o}function W(){a.g_initialRequestInvokedTime=new Date,a.g_initialRequestMade=!0,Object(C.a)("InitialRequestStart")}function U(e,t){a.g_getCellsFromFrameRequest=t,a.g_initialRequestCompleted=!0,a.g_initialResponseTime=new Date,Object(C.a)("InitialRequestEnd"),Object(C.a)("InitialResponseProcessStart"),Object(C.d)("InitialRequest","InitialRequestStart","InitialRequestEnd");var n=q(e);if(a.g_initialRequestResponseObject=n,n&&n.Responses&&n.Responses[0]&&n.Responses[0][1]){var i=n.Responses[0][1];a.g_acquireLockStartTime=i.AcquireLockStartTime,a.g_acquireLockEndTime=i.AcquireLockEndTime,a.g_acquireLockRequestStatus=i.AcquireLockRequestStatus,a.g_getDocumentStartTime=i.GetDocumentStartTime,a.g_getDocumentEndTime=i.GetDocumentEndTime,a.g_getDocumentRequestStatus=i.GetDocumentrequestStatus,a.g_getCellsStartTime=i.GetCellsStartTime,a.g_getCellsEndTime=i.GetCellsEndTime,a.g_getInitializeLocalCobaltStartTime=i.InitializeLocalCobaltStartTime,a.g_getInitializeLocalCobaltEndTime=i.InitializeLocalCobaltEndTime}a.g_initialResponseReadyTime=new Date,Object(C.a)("InitialResponseProcessEnd"),Object(C.d)("InitialResponseProcess","InitialResponseProcessStart","InitialResponseProcessEnd")}function q(e){try{return JSON.parse(e)}catch(e){o.fastBootError="JSON.parse failed: "+e.message+"\r\n"+e.stack}}var j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onOneNoteGetCellsRequestCompleted=function(e){Object(C.a)("ContentResponseEnd"),Object(C.d)("ContentRequestResponse","ContentRequestStart","ContentResponseEnd"),t.onGetCellsRequestCompleted(e);var n=N(a.g_initialRequestResponseObject);a.g_bootSSRData=n,n&&n.pageHtml&&(a.g_bootSSRHtmlStringLength=n.pageHtml.length),t.onInitialResponseReady(),O.g_bootSSRData=a.g_bootSSRData,O.g_onInitialResponseReceived?O.g_onInitialResponseReceived():O.g_initialResponseReceived=!0},t}return Object(F.d)(t,e),t.prototype.makeOneNoteGetCellsRequest=function(){this.makeGetCellsRequest(this.onOneNoteGetCellsRequestCompleted,!1),Object(C.a)("ContentRequestStart")},t}(D);function G(e,t){if(t){Object(C.a)("StartWacBoot"),b.ensureCookieCompliance("true"===e.MSCCEnabled,e.MSCCCookies);var n=function(e,t,n,i){return{baseDocId:e.BaseDocId,fastBootEnabled:"true"===e.FastBoot,getCachedSSR:"true"===e.GetCachedSSR,indexedDBPageTargetKey:"",initParagraphId:parseInt(e.InitialParaId,16),isIndexedDBEnabled:"true"===e.OneNoteIndexedDbCacheIsEnabled,isIndexedDBDefaultPageEnabled:"true"===e.OneNoteIndexedDBCacheDefaultPageIsEnabled,isOneNoteQuickloadCacheLocalStorageEnabled:"true"===e.OneNoteQuickloadCacheLocalStorageIsEnabled,isNewFile:"true"===e.CreateNew,isOneNoteHierarchySyncOnBootEnabled:"true"===e.OneNoteHierarchySyncIsEnabled,isOneNoteSyncConnectOnBootEnabled:"true"===e.OneNoteSyncConnectOnBootEnabled,isOneNoteSyncHeartBeatEnabled:"true"===e.OneNoteSyncHeartBeatIsEnabled,isUserCreatingPersonalNotebookFirstTime:"true"===e.IsUserCreatingPersonalNotebookFirstTime,oneNoteShouldSendQuerySignatureOnSocketSetup:"true"===e.OneNoteShouldSendQuerySignatureOnSocketSetup,contentSyncVersion:parseInt(e.OneNoteContentSyncVersion,10),optimizedForNewFile:n,pageTarget:e.PageTarget,pageTargetHtml:e.PageTargetHtml,requestOptions:_(e,t,i),sessionStartJson:e.SessionStartInfoJson?A(e.SessionStartInfoJson):"UNKNOWN",skipPageHtmlInGetCellsResponse:"true"===e.SkipPageHtmlInGetCellsResponse,slice0Name:e.Slice0Name,syncHeartBeatSendInterval:parseInt(e.OneNoteSyncHeartBeatSendIntervalMs,10),syncHeartBeatWaitInterval:parseInt(e.OneNoteSyncHeartBeatWaitIntervalMs,10),channelOutboundTimeoutInterval:parseInt(e.OneNoteSyncChannelOutboundTimeoutIntervalMs,10),userId:e.UserId}}(e,1,!1);if(a.g_isUserCreatingPersonalNotebookFirstTime=n.isUserCreatingPersonalNotebookFirstTime,n.isNewFile)return;var i=new x(!1,!1,!1,!0,e),o=new j(i,n);n.isOneNoteHierarchySyncOnBootEnabled||o.makeOneNoteGetCellsRequest(),"true"===e.OneNoteSkeletalBootUXIsEnabled&&S.launchExperience(e),a.g_networkType=Object(C.e)(),O.g_appSettings=e,O.g_bootOptions=n,O.g_fastViewLauncher=i,O.g_bootSettings=a}}n.d(t,"FastViewLogEntry",(function(){return y})),n.d(t,"FastView",(function(){return k})),n.d(t,"FastViewUtils",(function(){return b})),n.d(t,"isTouchSupport",(function(){return m})),n.d(t,"cssClassAbsolute",(function(){return"WACFastViewAbsolute"})),n.d(t,"cssClass",(function(){return"WACFastView"})),n.d(t,"cssPositionRewriteClass",(function(){return"WACFastViewPositionRewrite"})),n.d(t,"getFastViewCssClasses",(function(){return h})),n.d(t,"removeSplashScreen",(function(){return f})),n.d(t,"setFastViewScrollTop",(function(){return g})),n.d(t,"makeStyleChangesToHideHeader",(function(){return R})),n.d(t,"sendWacBeacon",(function(){return w})),n.d(t,"ShiftUtils",(function(){return E})),n.d(t,"SkeletalBoot",(function(){return S})),n.d(t,"SSRData",(function(){return P})),n.d(t,"getPageHtmlInfoFromGetCellsResponse",(function(){return N})),n.d(t,"bootSettings",(function(){return a})),n.d(t,"FastViewSettings",(function(){return o})),n.d(t,"WindowVisibilityMetrics",(function(){return I})),n.d(t,"settings",(function(){return O})),n.d(t,"startWacBoot",(function(){return G}))},353:function(e,t,n){"use strict";function i(){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw TypeError("predicate must be a function");for(var i=arguments[1],a=0;a<n;){var o=t[a];if(e.call(i,o,a,t))return o;a+=1}},configurable:!0,writable:!0})}function a(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i+=1){var a=arguments[i];if(null!=a)for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(n[o]=a[o])}return n},writable:!0,configurable:!0})}n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}))}});
//# sourceMappingURL=wacBoot.min.js.map